2025-11-06 23:24:13,503 - __main__ - INFO - ============================================================
2025-11-06 23:24:13,503 - __main__ - INFO - FEDERATED CLIENT: Client-01
2025-11-06 23:24:13,503 - __main__ - INFO - ============================================================
2025-11-06 23:24:13,503 - __main__ - INFO - Loading model from C:\Users\Nandini Devi\FedGuard-Project\results\models\ucsd_baseline.h5...
2025-11-06 23:24:13,818 - __main__ - INFO - [OK] Model loaded successfully
2025-11-06 23:24:13,819 - __main__ - INFO - Connecting to Kafka at localhost:9092...
2025-11-06 23:24:13,824 - kafka.conn - INFO - <BrokerConnection node_id=bootstrap-0 host=localhost:9092 <connecting> [IPv6 ('::1', 9092, 0, 0)]>: connecting to localhost:9092 [('::1', 9092, 0, 0) IPv6]
2025-11-06 23:24:13,825 - kafka.conn - INFO - Probing node bootstrap-0 broker version
2025-11-06 23:24:13,826 - kafka.conn - INFO - <BrokerConnection node_id=bootstrap-0 host=localhost:9092 <connecting> [IPv6 ('::1', 9092, 0, 0)]>: Connection complete.
2025-11-06 23:24:13,944 - kafka.conn - INFO - Broker version identified as 2.5.0
2025-11-06 23:24:13,945 - kafka.conn - INFO - Set configuration api_version=(2, 5, 0) to skip auto check_version requests on startup
2025-11-06 23:24:13,948 - __main__ - INFO - [OK] Kafka connection established
2025-11-06 23:24:13,948 - __main__ - INFO - Loading frames from: C:\Users\Nandini Devi\Downloads\uropds\UCSD_Anomaly_Dataset.v1p2\UCSDped1\Train\Train001
2025-11-06 23:24:13,956 - __main__ - INFO - [OK] Found 200 frames
2025-11-06 23:24:13,957 - __main__ - INFO - Batch size: 100 frames
2025-11-06 23:24:13,958 - __main__ - INFO - 
============================================================
2025-11-06 23:24:13,958 - __main__ - INFO - CLIENT RUNNING - Processing frames in loop
2025-11-06 23:24:13,958 - __main__ - INFO - ============================================================

2025-11-06 23:24:15,523 - __main__ - INFO - 
[Update #1] Collected 100 frames
2025-11-06 23:24:15,537 - __main__ - INFO - Performing local training...
2025-11-06 23:24:53,437 - __main__ - INFO - [OK] Training complete - Loss: 0.020209, Time: 37.90s
2025-11-06 23:24:53,742 - __main__ - INFO - Sending update to Kafka topic: 'model-updates'...
2025-11-06 23:24:55,660 - kafka.conn - INFO - <BrokerConnection node_id=1 host=localhost:9092 <connecting> [IPv6 ('::1', 9092, 0, 0)]>: connecting to localhost:9092 [('::1', 9092, 0, 0) IPv6]
2025-11-06 23:24:55,660 - __main__ - INFO - [OK] Update sent successfully (Send time: 1.92s)
2025-11-06 23:24:55,660 - __main__ - INFO - Total updates sent: 1
2025-11-06 23:24:55,660 - __main__ - INFO - Avg training time: 37.90s
2025-11-06 23:24:55,666 - kafka.conn - INFO - <BrokerConnection node_id=1 host=localhost:9092 <connecting> [IPv6 ('::1', 9092, 0, 0)]>: Connection complete.
2025-11-06 23:24:55,666 - kafka.conn - INFO - <BrokerConnection node_id=bootstrap-0 host=localhost:9092 <connected> [IPv6 ('::1', 9092, 0, 0)]>: Closing connection. 
2025-11-06 23:24:57,194 - __main__ - INFO - 
[Update #2] Collected 100 frames
2025-11-06 23:24:57,210 - __main__ - INFO - Performing local training...
2025-11-06 23:25:33,401 - __main__ - INFO - [OK] Training complete - Loss: 0.010561, Time: 36.19s
2025-11-06 23:25:33,550 - __main__ - INFO - Sending update to Kafka topic: 'model-updates'...
2025-11-06 23:25:35,265 - __main__ - INFO - [OK] Update sent successfully (Send time: 1.71s)
2025-11-06 23:25:35,266 - __main__ - INFO - Total updates sent: 2
2025-11-06 23:25:35,266 - __main__ - INFO - Avg training time: 37.04s
2025-11-06 23:25:36,698 - __main__ - INFO - 
[Update #3] Collected 100 frames
2025-11-06 23:25:36,718 - __main__ - INFO - Performing local training...
2025-11-06 23:26:14,239 - __main__ - INFO - [OK] Training complete - Loss: 0.007257, Time: 37.52s
2025-11-06 23:26:14,424 - __main__ - INFO - Sending update to Kafka topic: 'model-updates'...
2025-11-06 23:26:16,581 - __main__ - INFO - [OK] Update sent successfully (Send time: 2.16s)
2025-11-06 23:26:16,582 - __main__ - INFO - Total updates sent: 3
2025-11-06 23:26:16,582 - __main__ - INFO - Avg training time: 37.20s
2025-11-06 23:26:17,558 - __main__ - INFO - 
[Update #4] Collected 100 frames
2025-11-06 23:26:17,568 - __main__ - INFO - Performing local training...
2025-11-06 23:26:55,432 - __main__ - INFO - [OK] Training complete - Loss: 0.005151, Time: 37.86s
2025-11-06 23:26:55,572 - __main__ - INFO - Sending update to Kafka topic: 'model-updates'...
2025-11-06 23:26:57,712 - __main__ - INFO - [OK] Update sent successfully (Send time: 2.14s)
2025-11-06 23:26:57,712 - __main__ - INFO - Total updates sent: 4
2025-11-06 23:26:57,713 - __main__ - INFO - Avg training time: 37.37s
2025-11-06 23:26:59,150 - __main__ - INFO - 
[Update #5] Collected 100 frames
2025-11-06 23:26:59,170 - __main__ - INFO - Performing local training...
2025-11-06 23:27:39,448 - __main__ - INFO - [OK] Training complete - Loss: 0.004416, Time: 40.28s
2025-11-06 23:27:39,574 - __main__ - INFO - Sending update to Kafka topic: 'model-updates'...
2025-11-06 23:27:41,300 - __main__ - INFO - [OK] Update sent successfully (Send time: 1.73s)
2025-11-06 23:27:41,301 - __main__ - INFO - Total updates sent: 5
2025-11-06 23:27:41,302 - __main__ - INFO - Avg training time: 37.95s
2025-11-06 23:27:42,728 - __main__ - INFO - 
[Update #6] Collected 100 frames
2025-11-06 23:27:42,747 - __main__ - INFO - Performing local training...
2025-11-06 23:27:57,955 - kafka.conn - INFO - <BrokerConnection node_id=1 host=localhost:9092 <connected> [IPv6 ('::1', 9092, 0, 0)]>: Closing connection. KafkaConnectionError: Socket EVENT_READ without in-flight-requests
2025-11-06 23:27:57,958 - kafka.client - WARNING - Node 1 connection failed -- refreshing metadata
2025-11-06 23:27:58,022 - kafka.conn - INFO - <BrokerConnection node_id=1 host=localhost:9092 <connecting> [IPv4 ('127.0.0.1', 9092)]>: connecting to localhost:9092 [('127.0.0.1', 9092) IPv4]
2025-11-06 23:28:17,586 - __main__ - INFO - [OK] Training complete - Loss: 0.003314, Time: 34.84s
2025-11-06 23:28:17,742 - __main__ - INFO - Sending update to Kafka topic: 'model-updates'...
2025-11-06 23:28:19,377 - __main__ - INFO - [OK] Update sent successfully (Send time: 1.63s)
2025-11-06 23:28:19,377 - __main__ - INFO - Total updates sent: 6
2025-11-06 23:28:19,378 - __main__ - INFO - Avg training time: 37.43s
2025-11-06 23:28:20,947 - __main__ - INFO - 
[Update #7] Collected 100 frames
2025-11-06 23:28:20,963 - __main__ - INFO - Performing local training...
2025-11-06 23:28:52,963 - __main__ - INFO - [OK] Training complete - Loss: 0.002958, Time: 32.00s
2025-11-06 23:28:53,084 - __main__ - INFO - Sending update to Kafka topic: 'model-updates'...
2025-11-06 23:28:55,151 - __main__ - INFO - [OK] Update sent successfully (Send time: 2.07s)
2025-11-06 23:28:55,153 - __main__ - INFO - Total updates sent: 7
2025-11-06 23:28:55,154 - __main__ - INFO - Avg training time: 36.66s
2025-11-06 23:28:56,703 - __main__ - INFO - 
[Update #8] Collected 100 frames
2025-11-06 23:28:56,717 - __main__ - INFO - Performing local training...
2025-11-06 23:29:22,232 - __main__ - INFO - 

Keyboard interrupt received - shutting down client
2025-11-06 23:29:22,232 - __main__ - INFO - 
Cleaning up...
2025-11-06 23:29:22,247 - kafka.producer.kafka - INFO - Closing the Kafka producer with 4294967.0 secs timeout.
2025-11-06 23:29:22,248 - kafka.conn - INFO - <BrokerConnection node_id=1 host=localhost:9092 <connecting> [IPv4 ('127.0.0.1', 9092)]>: Closing connection. 
2025-11-06 23:29:22,249 - __main__ - INFO - Client Client-01 shut down successfully
