2025-11-08 21:19:22,559 - fedguard_client - INFO - ============================================================
2025-11-08 21:19:22,560 - fedguard_client - INFO - FEDERATED CLIENT: Client-01
2025-11-08 21:19:22,560 - fedguard_client - INFO - ============================================================
2025-11-08 21:19:22,560 - fedguard_client - INFO - Loading model from C:\Users\Nandini Devi\FedGuard-Project\results\models\ucsd_baseline.h5...
2025-11-08 21:19:26,219 - fedguard_client - INFO - [OK] Model loaded successfully
2025-11-08 21:19:26,219 - fedguard_client - INFO - Connecting to Kafka at localhost:9092 (topic: model-updates)...
2025-11-08 21:19:26,257 - kafka.conn - INFO - <BrokerConnection node_id=bootstrap-0 host=localhost:9092 <connecting> [IPv6 ('::1', 9092, 0, 0)]>: connecting to localhost:9092 [('::1', 9092, 0, 0) IPv6]
2025-11-08 21:19:26,259 - kafka.conn - INFO - Probing node bootstrap-0 broker version
2025-11-08 21:19:26,259 - kafka.conn - INFO - <BrokerConnection node_id=bootstrap-0 host=localhost:9092 <connecting> [IPv6 ('::1', 9092, 0, 0)]>: Connection complete.
2025-11-08 21:19:26,379 - kafka.conn - INFO - Broker version identified as 2.5.0
2025-11-08 21:19:26,381 - kafka.conn - INFO - Set configuration api_version=(2, 5, 0) to skip auto check_version requests on startup
2025-11-08 21:19:26,384 - fedguard_client - INFO - [OK] Kafka producer initialized
2025-11-08 21:19:26,385 - fedguard_client - INFO - Loading frames from: C:\Users\Nandini Devi\Downloads\uropds\UCSD_Anomaly_Dataset.v1p2\UCSDped1\Train\Train001
2025-11-08 21:19:26,386 - fedguard_client - INFO - [OK] Found 200 frames
2025-11-08 21:19:26,387 - fedguard_client - INFO - Batch size: 100 frames
2025-11-08 21:19:28,025 - fedguard_client - INFO - 
[Update #1] Collected 100 frames
2025-11-08 21:19:28,039 - fedguard_client - INFO - Performing local training...
2025-11-08 21:19:30,438 - fedguard_client - ERROR - FATAL ERROR (client): Graph execution error:

Detected at node 'autoencoder/conv2d/Relu' defined at (most recent call last):
    File "C:\Users\Nandini Devi\FedGuard-Project\federated\federated_client.py", line 215, in <module>
      main()
    File "C:\Users\Nandini Devi\FedGuard-Project\federated\federated_client.py", line 149, in main
      history = model.fit(
    File "C:\Users\Nandini Devi\FedGuard-Project\venv\lib\site-packages\keras\src\utils\traceback_utils.py", line 65, in error_handler
      return fn(*args, **kwargs)
    File "C:\Users\Nandini Devi\FedGuard-Project\venv\lib\site-packages\keras\src\engine\training.py", line 1742, in fit
      tmp_logs = self.train_function(iterator)
    File "C:\Users\Nandini Devi\FedGuard-Project\venv\lib\site-packages\keras\src\engine\training.py", line 1338, in train_function
      return step_function(self, iterator)
    File "C:\Users\Nandini Devi\FedGuard-Project\venv\lib\site-packages\keras\src\engine\training.py", line 1322, in step_function
      outputs = model.distribute_strategy.run(run_step, args=(data,))
    File "C:\Users\Nandini Devi\FedGuard-Project\venv\lib\site-packages\keras\src\engine\training.py", line 1303, in run_step
      outputs = model.train_step(data)
    File "C:\Users\Nandini Devi\FedGuard-Project\venv\lib\site-packages\keras\src\engine\training.py", line 1080, in train_step
      y_pred = self(x, training=True)
    File "C:\Users\Nandini Devi\FedGuard-Project\venv\lib\site-packages\keras\src\utils\traceback_utils.py", line 65, in error_handler
      return fn(*args, **kwargs)
    File "C:\Users\Nandini Devi\FedGuard-Project\venv\lib\site-packages\keras\src\engine\training.py", line 569, in __call__
      return super().__call__(*args, **kwargs)
    File "C:\Users\Nandini Devi\FedGuard-Project\venv\lib\site-packages\keras\src\utils\traceback_utils.py", line 65, in error_handler
      return fn(*args, **kwargs)
    File "C:\Users\Nandini Devi\FedGuard-Project\venv\lib\site-packages\keras\src\engine\base_layer.py", line 1150, in __call__
      outputs = call_fn(inputs, *args, **kwargs)
    File "C:\Users\Nandini Devi\FedGuard-Project\venv\lib\site-packages\keras\src\utils\traceback_utils.py", line 96, in error_handler
      return fn(*args, **kwargs)
    File "C:\Users\Nandini Devi\FedGuard-Project\venv\lib\site-packages\keras\src\engine\functional.py", line 512, in call
      return self._run_internal_graph(inputs, training=training, mask=mask)
    File "C:\Users\Nandini Devi\FedGuard-Project\venv\lib\site-packages\keras\src\engine\functional.py", line 669, in _run_internal_graph
      outputs = node.layer(*args, **kwargs)
    File "C:\Users\Nandini Devi\FedGuard-Project\venv\lib\site-packages\keras\src\utils\traceback_utils.py", line 65, in error_handler
      return fn(*args, **kwargs)
    File "C:\Users\Nandini Devi\FedGuard-Project\venv\lib\site-packages\keras\src\engine\base_layer.py", line 1150, in __call__
      outputs = call_fn(inputs, *args, **kwargs)
    File "C:\Users\Nandini Devi\FedGuard-Project\venv\lib\site-packages\keras\src\utils\traceback_utils.py", line 96, in error_handler
      return fn(*args, **kwargs)
    File "C:\Users\Nandini Devi\FedGuard-Project\venv\lib\site-packages\keras\src\layers\convolutional\base_conv.py", line 321, in call
      return self.activation(outputs)
    File "C:\Users\Nandini Devi\FedGuard-Project\venv\lib\site-packages\keras\src\activations.py", line 321, in relu
      return backend.relu(
    File "C:\Users\Nandini Devi\FedGuard-Project\venv\lib\site-packages\keras\src\backend.py", line 5397, in relu
      x = tf.nn.relu(x)
Node: 'autoencoder/conv2d/Relu'
OOM when allocating tensor with shape[16,256,256,32] and type float on /job:localhost/replica:0/task:0/device:CPU:0 by allocator cpu
	 [[{{node autoencoder/conv2d/Relu}}]]
Hint: If you want to see a list of allocated tensors when OOM happens, add report_tensor_allocations_upon_oom to RunOptions for current allocation info. This isn't available when running in Eager mode.
 [Op:__inference_train_function_4227]
Traceback (most recent call last):
  File "C:\Users\Nandini Devi\FedGuard-Project\federated\federated_client.py", line 149, in main
    history = model.fit(
  File "C:\Users\Nandini Devi\FedGuard-Project\venv\lib\site-packages\keras\src\utils\traceback_utils.py", line 70, in error_handler
    raise e.with_traceback(filtered_tb) from None
  File "C:\Users\Nandini Devi\FedGuard-Project\venv\lib\site-packages\tensorflow\python\eager\execute.py", line 53, in quick_execute
    tensors = pywrap_tfe.TFE_Py_Execute(ctx._handle, device_name, op_name,
tensorflow.python.framework.errors_impl.ResourceExhaustedError: Graph execution error:

Detected at node 'autoencoder/conv2d/Relu' defined at (most recent call last):
    File "C:\Users\Nandini Devi\FedGuard-Project\federated\federated_client.py", line 215, in <module>
      main()
    File "C:\Users\Nandini Devi\FedGuard-Project\federated\federated_client.py", line 149, in main
      history = model.fit(
    File "C:\Users\Nandini Devi\FedGuard-Project\venv\lib\site-packages\keras\src\utils\traceback_utils.py", line 65, in error_handler
      return fn(*args, **kwargs)
    File "C:\Users\Nandini Devi\FedGuard-Project\venv\lib\site-packages\keras\src\engine\training.py", line 1742, in fit
      tmp_logs = self.train_function(iterator)
    File "C:\Users\Nandini Devi\FedGuard-Project\venv\lib\site-packages\keras\src\engine\training.py", line 1338, in train_function
      return step_function(self, iterator)
    File "C:\Users\Nandini Devi\FedGuard-Project\venv\lib\site-packages\keras\src\engine\training.py", line 1322, in step_function
      outputs = model.distribute_strategy.run(run_step, args=(data,))
    File "C:\Users\Nandini Devi\FedGuard-Project\venv\lib\site-packages\keras\src\engine\training.py", line 1303, in run_step
      outputs = model.train_step(data)
    File "C:\Users\Nandini Devi\FedGuard-Project\venv\lib\site-packages\keras\src\engine\training.py", line 1080, in train_step
      y_pred = self(x, training=True)
    File "C:\Users\Nandini Devi\FedGuard-Project\venv\lib\site-packages\keras\src\utils\traceback_utils.py", line 65, in error_handler
      return fn(*args, **kwargs)
    File "C:\Users\Nandini Devi\FedGuard-Project\venv\lib\site-packages\keras\src\engine\training.py", line 569, in __call__
      return super().__call__(*args, **kwargs)
    File "C:\Users\Nandini Devi\FedGuard-Project\venv\lib\site-packages\keras\src\utils\traceback_utils.py", line 65, in error_handler
      return fn(*args, **kwargs)
    File "C:\Users\Nandini Devi\FedGuard-Project\venv\lib\site-packages\keras\src\engine\base_layer.py", line 1150, in __call__
      outputs = call_fn(inputs, *args, **kwargs)
    File "C:\Users\Nandini Devi\FedGuard-Project\venv\lib\site-packages\keras\src\utils\traceback_utils.py", line 96, in error_handler
      return fn(*args, **kwargs)
    File "C:\Users\Nandini Devi\FedGuard-Project\venv\lib\site-packages\keras\src\engine\functional.py", line 512, in call
      return self._run_internal_graph(inputs, training=training, mask=mask)
    File "C:\Users\Nandini Devi\FedGuard-Project\venv\lib\site-packages\keras\src\engine\functional.py", line 669, in _run_internal_graph
      outputs = node.layer(*args, **kwargs)
    File "C:\Users\Nandini Devi\FedGuard-Project\venv\lib\site-packages\keras\src\utils\traceback_utils.py", line 65, in error_handler
      return fn(*args, **kwargs)
    File "C:\Users\Nandini Devi\FedGuard-Project\venv\lib\site-packages\keras\src\engine\base_layer.py", line 1150, in __call__
      outputs = call_fn(inputs, *args, **kwargs)
    File "C:\Users\Nandini Devi\FedGuard-Project\venv\lib\site-packages\keras\src\utils\traceback_utils.py", line 96, in error_handler
      return fn(*args, **kwargs)
    File "C:\Users\Nandini Devi\FedGuard-Project\venv\lib\site-packages\keras\src\layers\convolutional\base_conv.py", line 321, in call
      return self.activation(outputs)
    File "C:\Users\Nandini Devi\FedGuard-Project\venv\lib\site-packages\keras\src\activations.py", line 321, in relu
      return backend.relu(
    File "C:\Users\Nandini Devi\FedGuard-Project\venv\lib\site-packages\keras\src\backend.py", line 5397, in relu
      x = tf.nn.relu(x)
Node: 'autoencoder/conv2d/Relu'
OOM when allocating tensor with shape[16,256,256,32] and type float on /job:localhost/replica:0/task:0/device:CPU:0 by allocator cpu
	 [[{{node autoencoder/conv2d/Relu}}]]
Hint: If you want to see a list of allocated tensors when OOM happens, add report_tensor_allocations_upon_oom to RunOptions for current allocation info. This isn't available when running in Eager mode.
 [Op:__inference_train_function_4227]
2025-11-08 21:19:30,453 - fedguard_client - INFO - Cleaning up client...
2025-11-08 21:19:30,536 - kafka.producer.kafka - INFO - Closing the Kafka producer with 4294967.0 secs timeout.
2025-11-08 21:19:30,543 - kafka.conn - INFO - <BrokerConnection node_id=bootstrap-0 host=localhost:9092 <connected> [IPv6 ('::1', 9092, 0, 0)]>: Closing connection. 
2025-11-08 21:19:30,544 - fedguard_client - INFO - Client Client-01 shut down successfully
