2025-11-08 21:25:38,887 - fedguard_client - INFO - ============================================================
2025-11-08 21:25:38,887 - fedguard_client - INFO - FEDERATED CLIENT: Client-01
2025-11-08 21:25:38,887 - fedguard_client - INFO - ============================================================
2025-11-08 21:25:38,887 - fedguard_client - INFO - Loading model from C:\Users\Nandini Devi\FedGuard-Project\results\models\ucsd_baseline.h5...
2025-11-08 21:25:45,793 - fedguard_client - INFO - [OK] Model loaded successfully
2025-11-08 21:25:45,793 - fedguard_client - INFO - Connecting to Kafka at localhost:9092 (topic: model-updates)...
2025-11-08 21:25:45,802 - kafka.conn - INFO - <BrokerConnection node_id=bootstrap-0 host=localhost:9092 <connecting> [IPv6 ('::1', 9092, 0, 0)]>: connecting to localhost:9092 [('::1', 9092, 0, 0) IPv6]
2025-11-08 21:25:45,803 - kafka.conn - INFO - Probing node bootstrap-0 broker version
2025-11-08 21:25:45,804 - kafka.conn - INFO - <BrokerConnection node_id=bootstrap-0 host=localhost:9092 <connecting> [IPv6 ('::1', 9092, 0, 0)]>: Connection complete.
2025-11-08 21:25:45,920 - kafka.conn - INFO - Broker version identified as 2.5.0
2025-11-08 21:25:45,920 - kafka.conn - INFO - Set configuration api_version=(2, 5, 0) to skip auto check_version requests on startup
2025-11-08 21:25:45,922 - fedguard_client - INFO - [OK] Kafka producer initialized
2025-11-08 21:25:45,922 - fedguard_client - INFO - Loading frames from: C:\Users\Nandini Devi\Downloads\uropds\UCSD_Anomaly_Dataset.v1p2\UCSDped1\Train\Train001
2025-11-08 21:25:45,987 - fedguard_client - INFO - [OK] Found 200 frames
2025-11-08 21:25:45,988 - fedguard_client - INFO - Frames per update: 16, Train batch size: 8, Image size: 128
2025-11-08 21:25:46,262 - fedguard_client - INFO - 
[Update #1] Collected 16 frames
2025-11-08 21:25:46,264 - fedguard_client - INFO - Performing local training...
2025-11-08 21:25:46,525 - fedguard_client - ERROR - Unexpected error during training
Traceback (most recent call last):
  File "C:\Users\Nandini Devi\FedGuard-Project\federated\federated_client.py", line 162, in main
    history = model.fit(
  File "C:\Users\Nandini Devi\FedGuard-Project\venv\lib\site-packages\keras\src\utils\traceback_utils.py", line 70, in error_handler
    raise e.with_traceback(filtered_tb) from None
  File "C:\Users\NANDIN~1\AppData\Local\Temp\__autograph_generated_filej6f9loxk.py", line 15, in tf__train_function
    retval_ = ag__.converted_call(ag__.ld(step_function), (ag__.ld(self), ag__.ld(iterator)), None, fscope)
ValueError: in user code:

    File "C:\Users\Nandini Devi\FedGuard-Project\venv\lib\site-packages\keras\src\engine\training.py", line 1338, in train_function  *
        return step_function(self, iterator)
    File "C:\Users\Nandini Devi\FedGuard-Project\venv\lib\site-packages\keras\src\engine\training.py", line 1322, in step_function  **
        outputs = model.distribute_strategy.run(run_step, args=(data,))
    File "C:\Users\Nandini Devi\FedGuard-Project\venv\lib\site-packages\keras\src\engine\training.py", line 1303, in run_step  **
        outputs = model.train_step(data)
    File "C:\Users\Nandini Devi\FedGuard-Project\venv\lib\site-packages\keras\src\engine\training.py", line 1080, in train_step
        y_pred = self(x, training=True)
    File "C:\Users\Nandini Devi\FedGuard-Project\venv\lib\site-packages\keras\src\utils\traceback_utils.py", line 70, in error_handler
        raise e.with_traceback(filtered_tb) from None
    File "C:\Users\Nandini Devi\FedGuard-Project\venv\lib\site-packages\keras\src\engine\input_spec.py", line 298, in assert_input_compatibility
        raise ValueError(

    ValueError: Input 0 of layer "autoencoder" is incompatible with the layer: expected shape=(None, 256, 256, 1), found shape=(8, 128, 128, 1)

2025-11-08 21:25:46,528 - fedguard_client - WARNING - Training failed or OOM. Training time: 0.26s
2025-11-08 21:25:47,525 - fedguard_client - INFO - Sending update to Kafka topic: 'model-updates' (payload size: 6508784 bytes, status: training_failed)...
2025-11-08 21:25:47,535 - kafka.conn - INFO - <BrokerConnection node_id=1 host=localhost:9092 <connecting> [IPv6 ('::1', 9092, 0, 0)]>: connecting to localhost:9092 [('::1', 9092, 0, 0) IPv6]
2025-11-08 21:25:47,536 - kafka.conn - INFO - <BrokerConnection node_id=1 host=localhost:9092 <connecting> [IPv6 ('::1', 9092, 0, 0)]>: Connection complete.
2025-11-08 21:25:47,537 - kafka.conn - INFO - <BrokerConnection node_id=bootstrap-0 host=localhost:9092 <connected> [IPv6 ('::1', 9092, 0, 0)]>: Closing connection. 
2025-11-08 21:25:49,998 - fedguard_client - INFO - [OK] Update sent successfully (Send time: 2.47s)
2025-11-08 21:25:50,002 - fedguard_client - INFO - Total updates sent: 1
2025-11-08 21:25:50,002 - fedguard_client - INFO - Avg training time: 0.26s
2025-11-08 21:25:50,250 - fedguard_client - INFO - 
[Update #2] Collected 16 frames
2025-11-08 21:25:50,251 - fedguard_client - INFO - Performing local training...
2025-11-08 21:25:50,489 - fedguard_client - ERROR - Unexpected error during training
Traceback (most recent call last):
  File "C:\Users\Nandini Devi\FedGuard-Project\federated\federated_client.py", line 162, in main
    history = model.fit(
  File "C:\Users\Nandini Devi\FedGuard-Project\venv\lib\site-packages\keras\src\utils\traceback_utils.py", line 70, in error_handler
    raise e.with_traceback(filtered_tb) from None
  File "C:\Users\NANDIN~1\AppData\Local\Temp\__autograph_generated_filej6f9loxk.py", line 15, in tf__train_function
    retval_ = ag__.converted_call(ag__.ld(step_function), (ag__.ld(self), ag__.ld(iterator)), None, fscope)
ValueError: in user code:

    File "C:\Users\Nandini Devi\FedGuard-Project\venv\lib\site-packages\keras\src\engine\training.py", line 1338, in train_function  *
        return step_function(self, iterator)
    File "C:\Users\Nandini Devi\FedGuard-Project\venv\lib\site-packages\keras\src\engine\training.py", line 1322, in step_function  **
        outputs = model.distribute_strategy.run(run_step, args=(data,))
    File "C:\Users\Nandini Devi\FedGuard-Project\venv\lib\site-packages\keras\src\engine\training.py", line 1303, in run_step  **
        outputs = model.train_step(data)
    File "C:\Users\Nandini Devi\FedGuard-Project\venv\lib\site-packages\keras\src\engine\training.py", line 1080, in train_step
        y_pred = self(x, training=True)
    File "C:\Users\Nandini Devi\FedGuard-Project\venv\lib\site-packages\keras\src\utils\traceback_utils.py", line 70, in error_handler
        raise e.with_traceback(filtered_tb) from None
    File "C:\Users\Nandini Devi\FedGuard-Project\venv\lib\site-packages\keras\src\engine\input_spec.py", line 298, in assert_input_compatibility
        raise ValueError(

    ValueError: Input 0 of layer "autoencoder" is incompatible with the layer: expected shape=(None, 256, 256, 1), found shape=(8, 128, 128, 1)

2025-11-08 21:25:50,491 - fedguard_client - WARNING - Training failed or OOM. Training time: 0.24s
2025-11-08 21:25:51,488 - fedguard_client - INFO - Sending update to Kafka topic: 'model-updates' (payload size: 6508784 bytes, status: training_failed)...
2025-11-08 21:25:53,687 - fedguard_client - INFO - [OK] Update sent successfully (Send time: 2.20s)
2025-11-08 21:25:53,688 - fedguard_client - INFO - Total updates sent: 2
2025-11-08 21:25:53,692 - fedguard_client - INFO - Avg training time: 0.25s
2025-11-08 21:25:53,936 - fedguard_client - INFO - 
[Update #3] Collected 16 frames
2025-11-08 21:25:53,938 - fedguard_client - INFO - Performing local training...
2025-11-08 21:25:54,053 - fedguard_client - ERROR - Unexpected error during training
Traceback (most recent call last):
  File "C:\Users\Nandini Devi\FedGuard-Project\federated\federated_client.py", line 162, in main
    history = model.fit(
  File "C:\Users\Nandini Devi\FedGuard-Project\venv\lib\site-packages\keras\src\utils\traceback_utils.py", line 70, in error_handler
    raise e.with_traceback(filtered_tb) from None
  File "C:\Users\NANDIN~1\AppData\Local\Temp\__autograph_generated_filej6f9loxk.py", line 15, in tf__train_function
    retval_ = ag__.converted_call(ag__.ld(step_function), (ag__.ld(self), ag__.ld(iterator)), None, fscope)
ValueError: in user code:

    File "C:\Users\Nandini Devi\FedGuard-Project\venv\lib\site-packages\keras\src\engine\training.py", line 1338, in train_function  *
        return step_function(self, iterator)
    File "C:\Users\Nandini Devi\FedGuard-Project\venv\lib\site-packages\keras\src\engine\training.py", line 1322, in step_function  **
        outputs = model.distribute_strategy.run(run_step, args=(data,))
    File "C:\Users\Nandini Devi\FedGuard-Project\venv\lib\site-packages\keras\src\engine\training.py", line 1303, in run_step  **
        outputs = model.train_step(data)
    File "C:\Users\Nandini Devi\FedGuard-Project\venv\lib\site-packages\keras\src\engine\training.py", line 1080, in train_step
        y_pred = self(x, training=True)
    File "C:\Users\Nandini Devi\FedGuard-Project\venv\lib\site-packages\keras\src\utils\traceback_utils.py", line 70, in error_handler
        raise e.with_traceback(filtered_tb) from None
    File "C:\Users\Nandini Devi\FedGuard-Project\venv\lib\site-packages\keras\src\engine\input_spec.py", line 298, in assert_input_compatibility
        raise ValueError(

    ValueError: Input 0 of layer "autoencoder" is incompatible with the layer: expected shape=(None, 256, 256, 1), found shape=(8, 128, 128, 1)

2025-11-08 21:25:54,054 - fedguard_client - WARNING - Training failed or OOM. Training time: 0.12s
2025-11-08 21:25:55,247 - fedguard_client - INFO - Sending update to Kafka topic: 'model-updates' (payload size: 6508784 bytes, status: training_failed)...
2025-11-08 21:25:57,710 - fedguard_client - INFO - [OK] Update sent successfully (Send time: 2.46s)
2025-11-08 21:25:57,711 - fedguard_client - INFO - Total updates sent: 3
2025-11-08 21:25:57,714 - fedguard_client - INFO - Avg training time: 0.21s
2025-11-08 21:25:57,975 - fedguard_client - INFO - 
[Update #4] Collected 16 frames
2025-11-08 21:25:57,980 - fedguard_client - INFO - Performing local training...
2025-11-08 21:25:58,118 - fedguard_client - ERROR - Unexpected error during training
Traceback (most recent call last):
  File "C:\Users\Nandini Devi\FedGuard-Project\federated\federated_client.py", line 162, in main
    history = model.fit(
  File "C:\Users\Nandini Devi\FedGuard-Project\venv\lib\site-packages\keras\src\utils\traceback_utils.py", line 70, in error_handler
    raise e.with_traceback(filtered_tb) from None
  File "C:\Users\NANDIN~1\AppData\Local\Temp\__autograph_generated_filej6f9loxk.py", line 15, in tf__train_function
    retval_ = ag__.converted_call(ag__.ld(step_function), (ag__.ld(self), ag__.ld(iterator)), None, fscope)
ValueError: in user code:

    File "C:\Users\Nandini Devi\FedGuard-Project\venv\lib\site-packages\keras\src\engine\training.py", line 1338, in train_function  *
        return step_function(self, iterator)
    File "C:\Users\Nandini Devi\FedGuard-Project\venv\lib\site-packages\keras\src\engine\training.py", line 1322, in step_function  **
        outputs = model.distribute_strategy.run(run_step, args=(data,))
    File "C:\Users\Nandini Devi\FedGuard-Project\venv\lib\site-packages\keras\src\engine\training.py", line 1303, in run_step  **
        outputs = model.train_step(data)
    File "C:\Users\Nandini Devi\FedGuard-Project\venv\lib\site-packages\keras\src\engine\training.py", line 1080, in train_step
        y_pred = self(x, training=True)
    File "C:\Users\Nandini Devi\FedGuard-Project\venv\lib\site-packages\keras\src\utils\traceback_utils.py", line 70, in error_handler
        raise e.with_traceback(filtered_tb) from None
    File "C:\Users\Nandini Devi\FedGuard-Project\venv\lib\site-packages\keras\src\engine\input_spec.py", line 298, in assert_input_compatibility
        raise ValueError(

    ValueError: Input 0 of layer "autoencoder" is incompatible with the layer: expected shape=(None, 256, 256, 1), found shape=(8, 128, 128, 1)

2025-11-08 21:25:58,119 - fedguard_client - WARNING - Training failed or OOM. Training time: 0.14s
2025-11-08 21:25:59,355 - fedguard_client - INFO - Sending update to Kafka topic: 'model-updates' (payload size: 6508784 bytes, status: training_failed)...
2025-11-08 21:26:02,304 - fedguard_client - INFO - [OK] Update sent successfully (Send time: 2.95s)
2025-11-08 21:26:02,311 - fedguard_client - INFO - Total updates sent: 4
2025-11-08 21:26:02,311 - fedguard_client - INFO - Avg training time: 0.19s
2025-11-08 21:26:02,573 - fedguard_client - INFO - 
[Update #5] Collected 16 frames
2025-11-08 21:26:02,576 - fedguard_client - INFO - Performing local training...
2025-11-08 21:26:02,730 - fedguard_client - ERROR - Unexpected error during training
Traceback (most recent call last):
  File "C:\Users\Nandini Devi\FedGuard-Project\federated\federated_client.py", line 162, in main
    history = model.fit(
  File "C:\Users\Nandini Devi\FedGuard-Project\venv\lib\site-packages\keras\src\utils\traceback_utils.py", line 70, in error_handler
    raise e.with_traceback(filtered_tb) from None
  File "C:\Users\NANDIN~1\AppData\Local\Temp\__autograph_generated_filej6f9loxk.py", line 15, in tf__train_function
    retval_ = ag__.converted_call(ag__.ld(step_function), (ag__.ld(self), ag__.ld(iterator)), None, fscope)
ValueError: in user code:

    File "C:\Users\Nandini Devi\FedGuard-Project\venv\lib\site-packages\keras\src\engine\training.py", line 1338, in train_function  *
        return step_function(self, iterator)
    File "C:\Users\Nandini Devi\FedGuard-Project\venv\lib\site-packages\keras\src\engine\training.py", line 1322, in step_function  **
        outputs = model.distribute_strategy.run(run_step, args=(data,))
    File "C:\Users\Nandini Devi\FedGuard-Project\venv\lib\site-packages\keras\src\engine\training.py", line 1303, in run_step  **
        outputs = model.train_step(data)
    File "C:\Users\Nandini Devi\FedGuard-Project\venv\lib\site-packages\keras\src\engine\training.py", line 1080, in train_step
        y_pred = self(x, training=True)
    File "C:\Users\Nandini Devi\FedGuard-Project\venv\lib\site-packages\keras\src\utils\traceback_utils.py", line 70, in error_handler
        raise e.with_traceback(filtered_tb) from None
    File "C:\Users\Nandini Devi\FedGuard-Project\venv\lib\site-packages\keras\src\engine\input_spec.py", line 298, in assert_input_compatibility
        raise ValueError(

    ValueError: Input 0 of layer "autoencoder" is incompatible with the layer: expected shape=(None, 256, 256, 1), found shape=(8, 128, 128, 1)

2025-11-08 21:26:02,732 - fedguard_client - WARNING - Training failed or OOM. Training time: 0.16s
2025-11-08 21:26:04,056 - fedguard_client - INFO - Sending update to Kafka topic: 'model-updates' (payload size: 6508784 bytes, status: training_failed)...
2025-11-08 21:26:06,445 - fedguard_client - INFO - [OK] Update sent successfully (Send time: 2.38s)
2025-11-08 21:26:06,447 - fedguard_client - INFO - Total updates sent: 5
2025-11-08 21:26:06,447 - fedguard_client - INFO - Avg training time: 0.18s
2025-11-08 21:26:06,758 - fedguard_client - INFO - 
[Update #6] Collected 16 frames
2025-11-08 21:26:06,760 - fedguard_client - INFO - Performing local training...
2025-11-08 21:26:06,895 - fedguard_client - ERROR - Unexpected error during training
Traceback (most recent call last):
  File "C:\Users\Nandini Devi\FedGuard-Project\federated\federated_client.py", line 162, in main
    history = model.fit(
  File "C:\Users\Nandini Devi\FedGuard-Project\venv\lib\site-packages\keras\src\utils\traceback_utils.py", line 70, in error_handler
    raise e.with_traceback(filtered_tb) from None
  File "C:\Users\NANDIN~1\AppData\Local\Temp\__autograph_generated_filej6f9loxk.py", line 15, in tf__train_function
    retval_ = ag__.converted_call(ag__.ld(step_function), (ag__.ld(self), ag__.ld(iterator)), None, fscope)
ValueError: in user code:

    File "C:\Users\Nandini Devi\FedGuard-Project\venv\lib\site-packages\keras\src\engine\training.py", line 1338, in train_function  *
        return step_function(self, iterator)
    File "C:\Users\Nandini Devi\FedGuard-Project\venv\lib\site-packages\keras\src\engine\training.py", line 1322, in step_function  **
        outputs = model.distribute_strategy.run(run_step, args=(data,))
    File "C:\Users\Nandini Devi\FedGuard-Project\venv\lib\site-packages\keras\src\engine\training.py", line 1303, in run_step  **
        outputs = model.train_step(data)
    File "C:\Users\Nandini Devi\FedGuard-Project\venv\lib\site-packages\keras\src\engine\training.py", line 1080, in train_step
        y_pred = self(x, training=True)
    File "C:\Users\Nandini Devi\FedGuard-Project\venv\lib\site-packages\keras\src\utils\traceback_utils.py", line 70, in error_handler
        raise e.with_traceback(filtered_tb) from None
    File "C:\Users\Nandini Devi\FedGuard-Project\venv\lib\site-packages\keras\src\engine\input_spec.py", line 298, in assert_input_compatibility
        raise ValueError(

    ValueError: Input 0 of layer "autoencoder" is incompatible with the layer: expected shape=(None, 256, 256, 1), found shape=(8, 128, 128, 1)

2025-11-08 21:26:06,897 - fedguard_client - WARNING - Training failed or OOM. Training time: 0.14s
2025-11-08 21:26:07,928 - fedguard_client - INFO - Sending update to Kafka topic: 'model-updates' (payload size: 6508784 bytes, status: training_failed)...
2025-11-08 21:26:10,176 - fedguard_client - INFO - [OK] Update sent successfully (Send time: 2.25s)
2025-11-08 21:26:10,180 - fedguard_client - INFO - Total updates sent: 6
2025-11-08 21:26:10,181 - fedguard_client - INFO - Avg training time: 0.18s
2025-11-08 21:26:10,600 - fedguard_client - INFO - 
[Update #7] Collected 16 frames
2025-11-08 21:26:10,600 - fedguard_client - INFO - Performing local training...
2025-11-08 21:26:10,697 - fedguard_client - ERROR - Unexpected error during training
Traceback (most recent call last):
  File "C:\Users\Nandini Devi\FedGuard-Project\federated\federated_client.py", line 162, in main
    history = model.fit(
  File "C:\Users\Nandini Devi\FedGuard-Project\venv\lib\site-packages\keras\src\utils\traceback_utils.py", line 70, in error_handler
    raise e.with_traceback(filtered_tb) from None
  File "C:\Users\NANDIN~1\AppData\Local\Temp\__autograph_generated_filej6f9loxk.py", line 15, in tf__train_function
    retval_ = ag__.converted_call(ag__.ld(step_function), (ag__.ld(self), ag__.ld(iterator)), None, fscope)
ValueError: in user code:

    File "C:\Users\Nandini Devi\FedGuard-Project\venv\lib\site-packages\keras\src\engine\training.py", line 1338, in train_function  *
        return step_function(self, iterator)
    File "C:\Users\Nandini Devi\FedGuard-Project\venv\lib\site-packages\keras\src\engine\training.py", line 1322, in step_function  **
        outputs = model.distribute_strategy.run(run_step, args=(data,))
    File "C:\Users\Nandini Devi\FedGuard-Project\venv\lib\site-packages\keras\src\engine\training.py", line 1303, in run_step  **
        outputs = model.train_step(data)
    File "C:\Users\Nandini Devi\FedGuard-Project\venv\lib\site-packages\keras\src\engine\training.py", line 1080, in train_step
        y_pred = self(x, training=True)
    File "C:\Users\Nandini Devi\FedGuard-Project\venv\lib\site-packages\keras\src\utils\traceback_utils.py", line 70, in error_handler
        raise e.with_traceback(filtered_tb) from None
    File "C:\Users\Nandini Devi\FedGuard-Project\venv\lib\site-packages\keras\src\engine\input_spec.py", line 298, in assert_input_compatibility
        raise ValueError(

    ValueError: Input 0 of layer "autoencoder" is incompatible with the layer: expected shape=(None, 256, 256, 1), found shape=(8, 128, 128, 1)

2025-11-08 21:26:10,699 - fedguard_client - WARNING - Training failed or OOM. Training time: 0.10s
2025-11-08 21:26:11,922 - fedguard_client - INFO - Sending update to Kafka topic: 'model-updates' (payload size: 6508784 bytes, status: training_failed)...
2025-11-08 21:26:14,255 - fedguard_client - INFO - [OK] Update sent successfully (Send time: 2.33s)
2025-11-08 21:26:14,258 - fedguard_client - INFO - Total updates sent: 7
2025-11-08 21:26:14,264 - fedguard_client - INFO - Avg training time: 0.16s
2025-11-08 21:26:14,771 - fedguard_client - INFO - 
[Update #8] Collected 16 frames
2025-11-08 21:26:14,772 - fedguard_client - INFO - Performing local training...
2025-11-08 21:26:14,893 - fedguard_client - ERROR - Unexpected error during training
Traceback (most recent call last):
  File "C:\Users\Nandini Devi\FedGuard-Project\federated\federated_client.py", line 162, in main
    history = model.fit(
  File "C:\Users\Nandini Devi\FedGuard-Project\venv\lib\site-packages\keras\src\utils\traceback_utils.py", line 70, in error_handler
    raise e.with_traceback(filtered_tb) from None
  File "C:\Users\NANDIN~1\AppData\Local\Temp\__autograph_generated_filej6f9loxk.py", line 15, in tf__train_function
    retval_ = ag__.converted_call(ag__.ld(step_function), (ag__.ld(self), ag__.ld(iterator)), None, fscope)
ValueError: in user code:

    File "C:\Users\Nandini Devi\FedGuard-Project\venv\lib\site-packages\keras\src\engine\training.py", line 1338, in train_function  *
        return step_function(self, iterator)
    File "C:\Users\Nandini Devi\FedGuard-Project\venv\lib\site-packages\keras\src\engine\training.py", line 1322, in step_function  **
        outputs = model.distribute_strategy.run(run_step, args=(data,))
    File "C:\Users\Nandini Devi\FedGuard-Project\venv\lib\site-packages\keras\src\engine\training.py", line 1303, in run_step  **
        outputs = model.train_step(data)
    File "C:\Users\Nandini Devi\FedGuard-Project\venv\lib\site-packages\keras\src\engine\training.py", line 1080, in train_step
        y_pred = self(x, training=True)
    File "C:\Users\Nandini Devi\FedGuard-Project\venv\lib\site-packages\keras\src\utils\traceback_utils.py", line 70, in error_handler
        raise e.with_traceback(filtered_tb) from None
    File "C:\Users\Nandini Devi\FedGuard-Project\venv\lib\site-packages\keras\src\engine\input_spec.py", line 298, in assert_input_compatibility
        raise ValueError(

    ValueError: Input 0 of layer "autoencoder" is incompatible with the layer: expected shape=(None, 256, 256, 1), found shape=(8, 128, 128, 1)

2025-11-08 21:26:14,894 - fedguard_client - WARNING - Training failed or OOM. Training time: 0.12s
2025-11-08 21:26:16,036 - fedguard_client - INFO - Sending update to Kafka topic: 'model-updates' (payload size: 6508784 bytes, status: training_failed)...
2025-11-08 21:26:18,367 - fedguard_client - INFO - [OK] Update sent successfully (Send time: 2.33s)
2025-11-08 21:26:18,374 - fedguard_client - INFO - Total updates sent: 8
2025-11-08 21:26:18,378 - fedguard_client - INFO - Avg training time: 0.16s
2025-11-08 21:26:19,112 - fedguard_client - INFO - 
[Update #9] Collected 16 frames
2025-11-08 21:26:19,113 - fedguard_client - INFO - Performing local training...
2025-11-08 21:26:19,241 - fedguard_client - ERROR - Unexpected error during training
Traceback (most recent call last):
  File "C:\Users\Nandini Devi\FedGuard-Project\federated\federated_client.py", line 162, in main
    history = model.fit(
  File "C:\Users\Nandini Devi\FedGuard-Project\venv\lib\site-packages\keras\src\utils\traceback_utils.py", line 70, in error_handler
    raise e.with_traceback(filtered_tb) from None
  File "C:\Users\NANDIN~1\AppData\Local\Temp\__autograph_generated_filej6f9loxk.py", line 15, in tf__train_function
    retval_ = ag__.converted_call(ag__.ld(step_function), (ag__.ld(self), ag__.ld(iterator)), None, fscope)
ValueError: in user code:

    File "C:\Users\Nandini Devi\FedGuard-Project\venv\lib\site-packages\keras\src\engine\training.py", line 1338, in train_function  *
        return step_function(self, iterator)
    File "C:\Users\Nandini Devi\FedGuard-Project\venv\lib\site-packages\keras\src\engine\training.py", line 1322, in step_function  **
        outputs = model.distribute_strategy.run(run_step, args=(data,))
    File "C:\Users\Nandini Devi\FedGuard-Project\venv\lib\site-packages\keras\src\engine\training.py", line 1303, in run_step  **
        outputs = model.train_step(data)
    File "C:\Users\Nandini Devi\FedGuard-Project\venv\lib\site-packages\keras\src\engine\training.py", line 1080, in train_step
        y_pred = self(x, training=True)
    File "C:\Users\Nandini Devi\FedGuard-Project\venv\lib\site-packages\keras\src\utils\traceback_utils.py", line 70, in error_handler
        raise e.with_traceback(filtered_tb) from None
    File "C:\Users\Nandini Devi\FedGuard-Project\venv\lib\site-packages\keras\src\engine\input_spec.py", line 298, in assert_input_compatibility
        raise ValueError(

    ValueError: Input 0 of layer "autoencoder" is incompatible with the layer: expected shape=(None, 256, 256, 1), found shape=(8, 128, 128, 1)

2025-11-08 21:26:19,245 - fedguard_client - WARNING - Training failed or OOM. Training time: 0.13s
2025-11-08 21:26:20,482 - fedguard_client - INFO - Sending update to Kafka topic: 'model-updates' (payload size: 6508784 bytes, status: training_failed)...
2025-11-08 21:26:23,072 - fedguard_client - INFO - [OK] Update sent successfully (Send time: 2.59s)
2025-11-08 21:26:23,076 - fedguard_client - INFO - Total updates sent: 9
2025-11-08 21:26:23,077 - fedguard_client - INFO - Avg training time: 0.16s
2025-11-08 21:26:23,564 - fedguard_client - INFO - 
[Update #10] Collected 16 frames
2025-11-08 21:26:23,565 - fedguard_client - INFO - Performing local training...
2025-11-08 21:26:23,689 - fedguard_client - ERROR - Unexpected error during training
Traceback (most recent call last):
  File "C:\Users\Nandini Devi\FedGuard-Project\federated\federated_client.py", line 162, in main
    history = model.fit(
  File "C:\Users\Nandini Devi\FedGuard-Project\venv\lib\site-packages\keras\src\utils\traceback_utils.py", line 70, in error_handler
    raise e.with_traceback(filtered_tb) from None
  File "C:\Users\NANDIN~1\AppData\Local\Temp\__autograph_generated_filej6f9loxk.py", line 15, in tf__train_function
    retval_ = ag__.converted_call(ag__.ld(step_function), (ag__.ld(self), ag__.ld(iterator)), None, fscope)
ValueError: in user code:

    File "C:\Users\Nandini Devi\FedGuard-Project\venv\lib\site-packages\keras\src\engine\training.py", line 1338, in train_function  *
        return step_function(self, iterator)
    File "C:\Users\Nandini Devi\FedGuard-Project\venv\lib\site-packages\keras\src\engine\training.py", line 1322, in step_function  **
        outputs = model.distribute_strategy.run(run_step, args=(data,))
    File "C:\Users\Nandini Devi\FedGuard-Project\venv\lib\site-packages\keras\src\engine\training.py", line 1303, in run_step  **
        outputs = model.train_step(data)
    File "C:\Users\Nandini Devi\FedGuard-Project\venv\lib\site-packages\keras\src\engine\training.py", line 1080, in train_step
        y_pred = self(x, training=True)
    File "C:\Users\Nandini Devi\FedGuard-Project\venv\lib\site-packages\keras\src\utils\traceback_utils.py", line 70, in error_handler
        raise e.with_traceback(filtered_tb) from None
    File "C:\Users\Nandini Devi\FedGuard-Project\venv\lib\site-packages\keras\src\engine\input_spec.py", line 298, in assert_input_compatibility
        raise ValueError(

    ValueError: Input 0 of layer "autoencoder" is incompatible with the layer: expected shape=(None, 256, 256, 1), found shape=(8, 128, 128, 1)

2025-11-08 21:26:23,691 - fedguard_client - WARNING - Training failed or OOM. Training time: 0.13s
2025-11-08 21:26:24,803 - fedguard_client - INFO - Sending update to Kafka topic: 'model-updates' (payload size: 6508784 bytes, status: training_failed)...
2025-11-08 21:26:27,242 - fedguard_client - INFO - [OK] Update sent successfully (Send time: 2.44s)
2025-11-08 21:26:27,243 - fedguard_client - INFO - Total updates sent: 10
2025-11-08 21:26:27,243 - fedguard_client - INFO - Avg training time: 0.15s
2025-11-08 21:26:27,766 - fedguard_client - INFO - 
[Update #11] Collected 16 frames
2025-11-08 21:26:27,767 - fedguard_client - INFO - Performing local training...
2025-11-08 21:26:27,884 - fedguard_client - ERROR - Unexpected error during training
Traceback (most recent call last):
  File "C:\Users\Nandini Devi\FedGuard-Project\federated\federated_client.py", line 162, in main
    history = model.fit(
  File "C:\Users\Nandini Devi\FedGuard-Project\venv\lib\site-packages\keras\src\utils\traceback_utils.py", line 70, in error_handler
    raise e.with_traceback(filtered_tb) from None
  File "C:\Users\NANDIN~1\AppData\Local\Temp\__autograph_generated_filej6f9loxk.py", line 15, in tf__train_function
    retval_ = ag__.converted_call(ag__.ld(step_function), (ag__.ld(self), ag__.ld(iterator)), None, fscope)
ValueError: in user code:

    File "C:\Users\Nandini Devi\FedGuard-Project\venv\lib\site-packages\keras\src\engine\training.py", line 1338, in train_function  *
        return step_function(self, iterator)
    File "C:\Users\Nandini Devi\FedGuard-Project\venv\lib\site-packages\keras\src\engine\training.py", line 1322, in step_function  **
        outputs = model.distribute_strategy.run(run_step, args=(data,))
    File "C:\Users\Nandini Devi\FedGuard-Project\venv\lib\site-packages\keras\src\engine\training.py", line 1303, in run_step  **
        outputs = model.train_step(data)
    File "C:\Users\Nandini Devi\FedGuard-Project\venv\lib\site-packages\keras\src\engine\training.py", line 1080, in train_step
        y_pred = self(x, training=True)
    File "C:\Users\Nandini Devi\FedGuard-Project\venv\lib\site-packages\keras\src\utils\traceback_utils.py", line 70, in error_handler
        raise e.with_traceback(filtered_tb) from None
    File "C:\Users\Nandini Devi\FedGuard-Project\venv\lib\site-packages\keras\src\engine\input_spec.py", line 298, in assert_input_compatibility
        raise ValueError(

    ValueError: Input 0 of layer "autoencoder" is incompatible with the layer: expected shape=(None, 256, 256, 1), found shape=(8, 128, 128, 1)

2025-11-08 21:26:27,886 - fedguard_client - WARNING - Training failed or OOM. Training time: 0.12s
2025-11-08 21:26:29,178 - fedguard_client - INFO - Sending update to Kafka topic: 'model-updates' (payload size: 6508784 bytes, status: training_failed)...
2025-11-08 21:26:32,415 - fedguard_client - INFO - [OK] Update sent successfully (Send time: 3.24s)
2025-11-08 21:26:32,415 - fedguard_client - INFO - Total updates sent: 11
2025-11-08 21:26:32,416 - fedguard_client - INFO - Avg training time: 0.15s
2025-11-08 21:26:33,108 - fedguard_client - INFO - 
[Update #12] Collected 16 frames
2025-11-08 21:26:33,110 - fedguard_client - INFO - Performing local training...
2025-11-08 21:26:33,259 - fedguard_client - ERROR - Unexpected error during training
Traceback (most recent call last):
  File "C:\Users\Nandini Devi\FedGuard-Project\federated\federated_client.py", line 162, in main
    history = model.fit(
  File "C:\Users\Nandini Devi\FedGuard-Project\venv\lib\site-packages\keras\src\utils\traceback_utils.py", line 70, in error_handler
    raise e.with_traceback(filtered_tb) from None
  File "C:\Users\NANDIN~1\AppData\Local\Temp\__autograph_generated_filej6f9loxk.py", line 15, in tf__train_function
    retval_ = ag__.converted_call(ag__.ld(step_function), (ag__.ld(self), ag__.ld(iterator)), None, fscope)
ValueError: in user code:

    File "C:\Users\Nandini Devi\FedGuard-Project\venv\lib\site-packages\keras\src\engine\training.py", line 1338, in train_function  *
        return step_function(self, iterator)
    File "C:\Users\Nandini Devi\FedGuard-Project\venv\lib\site-packages\keras\src\engine\training.py", line 1322, in step_function  **
        outputs = model.distribute_strategy.run(run_step, args=(data,))
    File "C:\Users\Nandini Devi\FedGuard-Project\venv\lib\site-packages\keras\src\engine\training.py", line 1303, in run_step  **
        outputs = model.train_step(data)
    File "C:\Users\Nandini Devi\FedGuard-Project\venv\lib\site-packages\keras\src\engine\training.py", line 1080, in train_step
        y_pred = self(x, training=True)
    File "C:\Users\Nandini Devi\FedGuard-Project\venv\lib\site-packages\keras\src\utils\traceback_utils.py", line 70, in error_handler
        raise e.with_traceback(filtered_tb) from None
    File "C:\Users\Nandini Devi\FedGuard-Project\venv\lib\site-packages\keras\src\engine\input_spec.py", line 298, in assert_input_compatibility
        raise ValueError(

    ValueError: Input 0 of layer "autoencoder" is incompatible with the layer: expected shape=(None, 256, 256, 1), found shape=(8, 128, 128, 1)

2025-11-08 21:26:33,262 - fedguard_client - WARNING - Training failed or OOM. Training time: 0.15s
2025-11-08 21:26:34,678 - fedguard_client - INFO - Sending update to Kafka topic: 'model-updates' (payload size: 6508784 bytes, status: training_failed)...
2025-11-08 21:26:37,620 - fedguard_client - INFO - [OK] Update sent successfully (Send time: 2.94s)
2025-11-08 21:26:37,620 - fedguard_client - INFO - Total updates sent: 12
2025-11-08 21:26:37,621 - fedguard_client - INFO - Avg training time: 0.15s
2025-11-08 21:26:38,022 - fedguard_client - INFO - 
[Update #13] Collected 16 frames
2025-11-08 21:26:38,025 - fedguard_client - INFO - Performing local training...
2025-11-08 21:26:38,124 - fedguard_client - ERROR - Unexpected error during training
Traceback (most recent call last):
  File "C:\Users\Nandini Devi\FedGuard-Project\federated\federated_client.py", line 162, in main
    history = model.fit(
  File "C:\Users\Nandini Devi\FedGuard-Project\venv\lib\site-packages\keras\src\utils\traceback_utils.py", line 70, in error_handler
    raise e.with_traceback(filtered_tb) from None
  File "C:\Users\NANDIN~1\AppData\Local\Temp\__autograph_generated_filej6f9loxk.py", line 15, in tf__train_function
    retval_ = ag__.converted_call(ag__.ld(step_function), (ag__.ld(self), ag__.ld(iterator)), None, fscope)
ValueError: in user code:

    File "C:\Users\Nandini Devi\FedGuard-Project\venv\lib\site-packages\keras\src\engine\training.py", line 1338, in train_function  *
        return step_function(self, iterator)
    File "C:\Users\Nandini Devi\FedGuard-Project\venv\lib\site-packages\keras\src\engine\training.py", line 1322, in step_function  **
        outputs = model.distribute_strategy.run(run_step, args=(data,))
    File "C:\Users\Nandini Devi\FedGuard-Project\venv\lib\site-packages\keras\src\engine\training.py", line 1303, in run_step  **
        outputs = model.train_step(data)
    File "C:\Users\Nandini Devi\FedGuard-Project\venv\lib\site-packages\keras\src\engine\training.py", line 1080, in train_step
        y_pred = self(x, training=True)
    File "C:\Users\Nandini Devi\FedGuard-Project\venv\lib\site-packages\keras\src\utils\traceback_utils.py", line 70, in error_handler
        raise e.with_traceback(filtered_tb) from None
    File "C:\Users\Nandini Devi\FedGuard-Project\venv\lib\site-packages\keras\src\engine\input_spec.py", line 298, in assert_input_compatibility
        raise ValueError(

    ValueError: Input 0 of layer "autoencoder" is incompatible with the layer: expected shape=(None, 256, 256, 1), found shape=(8, 128, 128, 1)

2025-11-08 21:26:38,150 - fedguard_client - WARNING - Training failed or OOM. Training time: 0.13s
2025-11-08 21:26:39,152 - fedguard_client - INFO - Sending update to Kafka topic: 'model-updates' (payload size: 6508784 bytes, status: training_failed)...
2025-11-08 21:26:41,282 - fedguard_client - INFO - [OK] Update sent successfully (Send time: 2.13s)
2025-11-08 21:26:41,283 - fedguard_client - INFO - Total updates sent: 13
2025-11-08 21:26:41,284 - fedguard_client - INFO - Avg training time: 0.15s
2025-11-08 21:26:41,507 - fedguard_client - INFO - 
[Update #14] Collected 16 frames
2025-11-08 21:26:41,508 - fedguard_client - INFO - Performing local training...
2025-11-08 21:26:41,620 - fedguard_client - ERROR - Unexpected error during training
Traceback (most recent call last):
  File "C:\Users\Nandini Devi\FedGuard-Project\federated\federated_client.py", line 162, in main
    history = model.fit(
  File "C:\Users\Nandini Devi\FedGuard-Project\venv\lib\site-packages\keras\src\utils\traceback_utils.py", line 70, in error_handler
    raise e.with_traceback(filtered_tb) from None
  File "C:\Users\NANDIN~1\AppData\Local\Temp\__autograph_generated_filej6f9loxk.py", line 15, in tf__train_function
    retval_ = ag__.converted_call(ag__.ld(step_function), (ag__.ld(self), ag__.ld(iterator)), None, fscope)
ValueError: in user code:

    File "C:\Users\Nandini Devi\FedGuard-Project\venv\lib\site-packages\keras\src\engine\training.py", line 1338, in train_function  *
        return step_function(self, iterator)
    File "C:\Users\Nandini Devi\FedGuard-Project\venv\lib\site-packages\keras\src\engine\training.py", line 1322, in step_function  **
        outputs = model.distribute_strategy.run(run_step, args=(data,))
    File "C:\Users\Nandini Devi\FedGuard-Project\venv\lib\site-packages\keras\src\engine\training.py", line 1303, in run_step  **
        outputs = model.train_step(data)
    File "C:\Users\Nandini Devi\FedGuard-Project\venv\lib\site-packages\keras\src\engine\training.py", line 1080, in train_step
        y_pred = self(x, training=True)
    File "C:\Users\Nandini Devi\FedGuard-Project\venv\lib\site-packages\keras\src\utils\traceback_utils.py", line 70, in error_handler
        raise e.with_traceback(filtered_tb) from None
    File "C:\Users\Nandini Devi\FedGuard-Project\venv\lib\site-packages\keras\src\engine\input_spec.py", line 298, in assert_input_compatibility
        raise ValueError(

    ValueError: Input 0 of layer "autoencoder" is incompatible with the layer: expected shape=(None, 256, 256, 1), found shape=(8, 128, 128, 1)

2025-11-08 21:26:41,624 - fedguard_client - WARNING - Training failed or OOM. Training time: 0.12s
2025-11-08 21:26:42,609 - fedguard_client - INFO - Sending update to Kafka topic: 'model-updates' (payload size: 6508784 bytes, status: training_failed)...
2025-11-08 21:26:44,881 - fedguard_client - INFO - [OK] Update sent successfully (Send time: 2.27s)
2025-11-08 21:26:44,882 - fedguard_client - INFO - Total updates sent: 14
2025-11-08 21:26:44,882 - fedguard_client - INFO - Avg training time: 0.15s
2025-11-08 21:26:45,121 - fedguard_client - INFO - 
[Update #15] Collected 16 frames
2025-11-08 21:26:45,122 - fedguard_client - INFO - Performing local training...
2025-11-08 21:26:45,218 - fedguard_client - ERROR - Unexpected error during training
Traceback (most recent call last):
  File "C:\Users\Nandini Devi\FedGuard-Project\federated\federated_client.py", line 162, in main
    history = model.fit(
  File "C:\Users\Nandini Devi\FedGuard-Project\venv\lib\site-packages\keras\src\utils\traceback_utils.py", line 70, in error_handler
    raise e.with_traceback(filtered_tb) from None
  File "C:\Users\NANDIN~1\AppData\Local\Temp\__autograph_generated_filej6f9loxk.py", line 15, in tf__train_function
    retval_ = ag__.converted_call(ag__.ld(step_function), (ag__.ld(self), ag__.ld(iterator)), None, fscope)
ValueError: in user code:

    File "C:\Users\Nandini Devi\FedGuard-Project\venv\lib\site-packages\keras\src\engine\training.py", line 1338, in train_function  *
        return step_function(self, iterator)
    File "C:\Users\Nandini Devi\FedGuard-Project\venv\lib\site-packages\keras\src\engine\training.py", line 1322, in step_function  **
        outputs = model.distribute_strategy.run(run_step, args=(data,))
    File "C:\Users\Nandini Devi\FedGuard-Project\venv\lib\site-packages\keras\src\engine\training.py", line 1303, in run_step  **
        outputs = model.train_step(data)
    File "C:\Users\Nandini Devi\FedGuard-Project\venv\lib\site-packages\keras\src\engine\training.py", line 1080, in train_step
        y_pred = self(x, training=True)
    File "C:\Users\Nandini Devi\FedGuard-Project\venv\lib\site-packages\keras\src\utils\traceback_utils.py", line 70, in error_handler
        raise e.with_traceback(filtered_tb) from None
    File "C:\Users\Nandini Devi\FedGuard-Project\venv\lib\site-packages\keras\src\engine\input_spec.py", line 298, in assert_input_compatibility
        raise ValueError(

    ValueError: Input 0 of layer "autoencoder" is incompatible with the layer: expected shape=(None, 256, 256, 1), found shape=(8, 128, 128, 1)

2025-11-08 21:26:45,219 - fedguard_client - WARNING - Training failed or OOM. Training time: 0.10s
2025-11-08 21:26:46,203 - fedguard_client - INFO - Sending update to Kafka topic: 'model-updates' (payload size: 6508784 bytes, status: training_failed)...
2025-11-08 21:26:48,356 - fedguard_client - INFO - [OK] Update sent successfully (Send time: 2.15s)
2025-11-08 21:26:48,357 - fedguard_client - INFO - Total updates sent: 15
2025-11-08 21:26:48,357 - fedguard_client - INFO - Avg training time: 0.14s
2025-11-08 21:26:48,608 - fedguard_client - INFO - 
[Update #16] Collected 16 frames
2025-11-08 21:26:48,610 - fedguard_client - INFO - Performing local training...
2025-11-08 21:26:48,756 - fedguard_client - ERROR - Unexpected error during training
Traceback (most recent call last):
  File "C:\Users\Nandini Devi\FedGuard-Project\federated\federated_client.py", line 162, in main
    history = model.fit(
  File "C:\Users\Nandini Devi\FedGuard-Project\venv\lib\site-packages\keras\src\utils\traceback_utils.py", line 70, in error_handler
    raise e.with_traceback(filtered_tb) from None
  File "C:\Users\NANDIN~1\AppData\Local\Temp\__autograph_generated_filej6f9loxk.py", line 15, in tf__train_function
    retval_ = ag__.converted_call(ag__.ld(step_function), (ag__.ld(self), ag__.ld(iterator)), None, fscope)
ValueError: in user code:

    File "C:\Users\Nandini Devi\FedGuard-Project\venv\lib\site-packages\keras\src\engine\training.py", line 1338, in train_function  *
        return step_function(self, iterator)
    File "C:\Users\Nandini Devi\FedGuard-Project\venv\lib\site-packages\keras\src\engine\training.py", line 1322, in step_function  **
        outputs = model.distribute_strategy.run(run_step, args=(data,))
    File "C:\Users\Nandini Devi\FedGuard-Project\venv\lib\site-packages\keras\src\engine\training.py", line 1303, in run_step  **
        outputs = model.train_step(data)
    File "C:\Users\Nandini Devi\FedGuard-Project\venv\lib\site-packages\keras\src\engine\training.py", line 1080, in train_step
        y_pred = self(x, training=True)
    File "C:\Users\Nandini Devi\FedGuard-Project\venv\lib\site-packages\keras\src\utils\traceback_utils.py", line 70, in error_handler
        raise e.with_traceback(filtered_tb) from None
    File "C:\Users\Nandini Devi\FedGuard-Project\venv\lib\site-packages\keras\src\engine\input_spec.py", line 298, in assert_input_compatibility
        raise ValueError(

    ValueError: Input 0 of layer "autoencoder" is incompatible with the layer: expected shape=(None, 256, 256, 1), found shape=(8, 128, 128, 1)

2025-11-08 21:26:48,757 - fedguard_client - WARNING - Training failed or OOM. Training time: 0.15s
2025-11-08 21:26:49,809 - fedguard_client - INFO - Sending update to Kafka topic: 'model-updates' (payload size: 6508784 bytes, status: training_failed)...
2025-11-08 21:26:52,031 - fedguard_client - INFO - [OK] Update sent successfully (Send time: 2.22s)
2025-11-08 21:26:52,033 - fedguard_client - INFO - Total updates sent: 16
2025-11-08 21:26:52,034 - fedguard_client - INFO - Avg training time: 0.14s
2025-11-08 21:26:52,256 - fedguard_client - INFO - 
[Update #17] Collected 16 frames
2025-11-08 21:26:52,258 - fedguard_client - INFO - Performing local training...
2025-11-08 21:26:52,390 - fedguard_client - ERROR - Unexpected error during training
Traceback (most recent call last):
  File "C:\Users\Nandini Devi\FedGuard-Project\federated\federated_client.py", line 162, in main
    history = model.fit(
  File "C:\Users\Nandini Devi\FedGuard-Project\venv\lib\site-packages\keras\src\utils\traceback_utils.py", line 70, in error_handler
    raise e.with_traceback(filtered_tb) from None
  File "C:\Users\NANDIN~1\AppData\Local\Temp\__autograph_generated_filej6f9loxk.py", line 15, in tf__train_function
    retval_ = ag__.converted_call(ag__.ld(step_function), (ag__.ld(self), ag__.ld(iterator)), None, fscope)
ValueError: in user code:

    File "C:\Users\Nandini Devi\FedGuard-Project\venv\lib\site-packages\keras\src\engine\training.py", line 1338, in train_function  *
        return step_function(self, iterator)
    File "C:\Users\Nandini Devi\FedGuard-Project\venv\lib\site-packages\keras\src\engine\training.py", line 1322, in step_function  **
        outputs = model.distribute_strategy.run(run_step, args=(data,))
    File "C:\Users\Nandini Devi\FedGuard-Project\venv\lib\site-packages\keras\src\engine\training.py", line 1303, in run_step  **
        outputs = model.train_step(data)
    File "C:\Users\Nandini Devi\FedGuard-Project\venv\lib\site-packages\keras\src\engine\training.py", line 1080, in train_step
        y_pred = self(x, training=True)
    File "C:\Users\Nandini Devi\FedGuard-Project\venv\lib\site-packages\keras\src\utils\traceback_utils.py", line 70, in error_handler
        raise e.with_traceback(filtered_tb) from None
    File "C:\Users\Nandini Devi\FedGuard-Project\venv\lib\site-packages\keras\src\engine\input_spec.py", line 298, in assert_input_compatibility
        raise ValueError(

    ValueError: Input 0 of layer "autoencoder" is incompatible with the layer: expected shape=(None, 256, 256, 1), found shape=(8, 128, 128, 1)

2025-11-08 21:26:52,392 - fedguard_client - WARNING - Training failed or OOM. Training time: 0.13s
2025-11-08 21:26:53,640 - fedguard_client - INFO - Sending update to Kafka topic: 'model-updates' (payload size: 6508784 bytes, status: training_failed)...
2025-11-08 21:26:56,386 - fedguard_client - INFO - [OK] Update sent successfully (Send time: 2.74s)
2025-11-08 21:26:56,387 - fedguard_client - INFO - Total updates sent: 17
2025-11-08 21:26:56,388 - fedguard_client - INFO - Avg training time: 0.14s
2025-11-08 21:26:56,617 - fedguard_client - INFO - 
[Update #18] Collected 16 frames
2025-11-08 21:26:56,618 - fedguard_client - INFO - Performing local training...
2025-11-08 21:26:56,764 - fedguard_client - ERROR - Unexpected error during training
Traceback (most recent call last):
  File "C:\Users\Nandini Devi\FedGuard-Project\federated\federated_client.py", line 162, in main
    history = model.fit(
  File "C:\Users\Nandini Devi\FedGuard-Project\venv\lib\site-packages\keras\src\utils\traceback_utils.py", line 70, in error_handler
    raise e.with_traceback(filtered_tb) from None
  File "C:\Users\NANDIN~1\AppData\Local\Temp\__autograph_generated_filej6f9loxk.py", line 15, in tf__train_function
    retval_ = ag__.converted_call(ag__.ld(step_function), (ag__.ld(self), ag__.ld(iterator)), None, fscope)
ValueError: in user code:

    File "C:\Users\Nandini Devi\FedGuard-Project\venv\lib\site-packages\keras\src\engine\training.py", line 1338, in train_function  *
        return step_function(self, iterator)
    File "C:\Users\Nandini Devi\FedGuard-Project\venv\lib\site-packages\keras\src\engine\training.py", line 1322, in step_function  **
        outputs = model.distribute_strategy.run(run_step, args=(data,))
    File "C:\Users\Nandini Devi\FedGuard-Project\venv\lib\site-packages\keras\src\engine\training.py", line 1303, in run_step  **
        outputs = model.train_step(data)
    File "C:\Users\Nandini Devi\FedGuard-Project\venv\lib\site-packages\keras\src\engine\training.py", line 1080, in train_step
        y_pred = self(x, training=True)
    File "C:\Users\Nandini Devi\FedGuard-Project\venv\lib\site-packages\keras\src\utils\traceback_utils.py", line 70, in error_handler
        raise e.with_traceback(filtered_tb) from None
    File "C:\Users\Nandini Devi\FedGuard-Project\venv\lib\site-packages\keras\src\engine\input_spec.py", line 298, in assert_input_compatibility
        raise ValueError(

    ValueError: Input 0 of layer "autoencoder" is incompatible with the layer: expected shape=(None, 256, 256, 1), found shape=(8, 128, 128, 1)

2025-11-08 21:26:56,765 - fedguard_client - WARNING - Training failed or OOM. Training time: 0.15s
2025-11-08 21:26:57,780 - fedguard_client - INFO - Sending update to Kafka topic: 'model-updates' (payload size: 6508784 bytes, status: training_failed)...
2025-11-08 21:27:00,286 - fedguard_client - INFO - [OK] Update sent successfully (Send time: 2.50s)
2025-11-08 21:27:00,286 - fedguard_client - INFO - Total updates sent: 18
2025-11-08 21:27:00,289 - fedguard_client - INFO - Avg training time: 0.14s
2025-11-08 21:27:00,532 - fedguard_client - INFO - 
[Update #19] Collected 16 frames
2025-11-08 21:27:00,534 - fedguard_client - INFO - Performing local training...
2025-11-08 21:27:00,658 - fedguard_client - ERROR - Unexpected error during training
Traceback (most recent call last):
  File "C:\Users\Nandini Devi\FedGuard-Project\federated\federated_client.py", line 162, in main
    history = model.fit(
  File "C:\Users\Nandini Devi\FedGuard-Project\venv\lib\site-packages\keras\src\utils\traceback_utils.py", line 70, in error_handler
    raise e.with_traceback(filtered_tb) from None
  File "C:\Users\NANDIN~1\AppData\Local\Temp\__autograph_generated_filej6f9loxk.py", line 15, in tf__train_function
    retval_ = ag__.converted_call(ag__.ld(step_function), (ag__.ld(self), ag__.ld(iterator)), None, fscope)
ValueError: in user code:

    File "C:\Users\Nandini Devi\FedGuard-Project\venv\lib\site-packages\keras\src\engine\training.py", line 1338, in train_function  *
        return step_function(self, iterator)
    File "C:\Users\Nandini Devi\FedGuard-Project\venv\lib\site-packages\keras\src\engine\training.py", line 1322, in step_function  **
        outputs = model.distribute_strategy.run(run_step, args=(data,))
    File "C:\Users\Nandini Devi\FedGuard-Project\venv\lib\site-packages\keras\src\engine\training.py", line 1303, in run_step  **
        outputs = model.train_step(data)
    File "C:\Users\Nandini Devi\FedGuard-Project\venv\lib\site-packages\keras\src\engine\training.py", line 1080, in train_step
        y_pred = self(x, training=True)
    File "C:\Users\Nandini Devi\FedGuard-Project\venv\lib\site-packages\keras\src\utils\traceback_utils.py", line 70, in error_handler
        raise e.with_traceback(filtered_tb) from None
    File "C:\Users\Nandini Devi\FedGuard-Project\venv\lib\site-packages\keras\src\engine\input_spec.py", line 298, in assert_input_compatibility
        raise ValueError(

    ValueError: Input 0 of layer "autoencoder" is incompatible with the layer: expected shape=(None, 256, 256, 1), found shape=(8, 128, 128, 1)

2025-11-08 21:27:00,659 - fedguard_client - WARNING - Training failed or OOM. Training time: 0.12s
2025-11-08 21:27:01,864 - fedguard_client - INFO - Sending update to Kafka topic: 'model-updates' (payload size: 6508784 bytes, status: training_failed)...
2025-11-08 21:27:05,241 - fedguard_client - INFO - [OK] Update sent successfully (Send time: 3.37s)
2025-11-08 21:27:05,241 - fedguard_client - INFO - Total updates sent: 19
2025-11-08 21:27:05,242 - fedguard_client - INFO - Avg training time: 0.14s
2025-11-08 21:27:05,461 - fedguard_client - INFO - 
[Update #20] Collected 16 frames
2025-11-08 21:27:05,462 - fedguard_client - INFO - Performing local training...
2025-11-08 21:27:05,605 - fedguard_client - ERROR - Unexpected error during training
Traceback (most recent call last):
  File "C:\Users\Nandini Devi\FedGuard-Project\federated\federated_client.py", line 162, in main
    history = model.fit(
  File "C:\Users\Nandini Devi\FedGuard-Project\venv\lib\site-packages\keras\src\utils\traceback_utils.py", line 70, in error_handler
    raise e.with_traceback(filtered_tb) from None
  File "C:\Users\NANDIN~1\AppData\Local\Temp\__autograph_generated_filej6f9loxk.py", line 15, in tf__train_function
    retval_ = ag__.converted_call(ag__.ld(step_function), (ag__.ld(self), ag__.ld(iterator)), None, fscope)
ValueError: in user code:

    File "C:\Users\Nandini Devi\FedGuard-Project\venv\lib\site-packages\keras\src\engine\training.py", line 1338, in train_function  *
        return step_function(self, iterator)
    File "C:\Users\Nandini Devi\FedGuard-Project\venv\lib\site-packages\keras\src\engine\training.py", line 1322, in step_function  **
        outputs = model.distribute_strategy.run(run_step, args=(data,))
    File "C:\Users\Nandini Devi\FedGuard-Project\venv\lib\site-packages\keras\src\engine\training.py", line 1303, in run_step  **
        outputs = model.train_step(data)
    File "C:\Users\Nandini Devi\FedGuard-Project\venv\lib\site-packages\keras\src\engine\training.py", line 1080, in train_step
        y_pred = self(x, training=True)
    File "C:\Users\Nandini Devi\FedGuard-Project\venv\lib\site-packages\keras\src\utils\traceback_utils.py", line 70, in error_handler
        raise e.with_traceback(filtered_tb) from None
    File "C:\Users\Nandini Devi\FedGuard-Project\venv\lib\site-packages\keras\src\engine\input_spec.py", line 298, in assert_input_compatibility
        raise ValueError(

    ValueError: Input 0 of layer "autoencoder" is incompatible with the layer: expected shape=(None, 256, 256, 1), found shape=(8, 128, 128, 1)

2025-11-08 21:27:05,606 - fedguard_client - WARNING - Training failed or OOM. Training time: 0.14s
2025-11-08 21:27:06,936 - fedguard_client - INFO - Sending update to Kafka topic: 'model-updates' (payload size: 6508784 bytes, status: training_failed)...
2025-11-08 21:27:09,861 - fedguard_client - INFO - [OK] Update sent successfully (Send time: 2.92s)
2025-11-08 21:27:09,861 - fedguard_client - INFO - Total updates sent: 20
2025-11-08 21:27:09,861 - fedguard_client - INFO - Avg training time: 0.14s
2025-11-08 21:27:10,106 - fedguard_client - INFO - 
[Update #21] Collected 16 frames
2025-11-08 21:27:10,108 - fedguard_client - INFO - Performing local training...
2025-11-08 21:27:10,261 - fedguard_client - ERROR - Unexpected error during training
Traceback (most recent call last):
  File "C:\Users\Nandini Devi\FedGuard-Project\federated\federated_client.py", line 162, in main
    history = model.fit(
  File "C:\Users\Nandini Devi\FedGuard-Project\venv\lib\site-packages\keras\src\utils\traceback_utils.py", line 70, in error_handler
    raise e.with_traceback(filtered_tb) from None
  File "C:\Users\NANDIN~1\AppData\Local\Temp\__autograph_generated_filej6f9loxk.py", line 15, in tf__train_function
    retval_ = ag__.converted_call(ag__.ld(step_function), (ag__.ld(self), ag__.ld(iterator)), None, fscope)
ValueError: in user code:

    File "C:\Users\Nandini Devi\FedGuard-Project\venv\lib\site-packages\keras\src\engine\training.py", line 1338, in train_function  *
        return step_function(self, iterator)
    File "C:\Users\Nandini Devi\FedGuard-Project\venv\lib\site-packages\keras\src\engine\training.py", line 1322, in step_function  **
        outputs = model.distribute_strategy.run(run_step, args=(data,))
    File "C:\Users\Nandini Devi\FedGuard-Project\venv\lib\site-packages\keras\src\engine\training.py", line 1303, in run_step  **
        outputs = model.train_step(data)
    File "C:\Users\Nandini Devi\FedGuard-Project\venv\lib\site-packages\keras\src\engine\training.py", line 1080, in train_step
        y_pred = self(x, training=True)
    File "C:\Users\Nandini Devi\FedGuard-Project\venv\lib\site-packages\keras\src\utils\traceback_utils.py", line 70, in error_handler
        raise e.with_traceback(filtered_tb) from None
    File "C:\Users\Nandini Devi\FedGuard-Project\venv\lib\site-packages\keras\src\engine\input_spec.py", line 298, in assert_input_compatibility
        raise ValueError(

    ValueError: Input 0 of layer "autoencoder" is incompatible with the layer: expected shape=(None, 256, 256, 1), found shape=(8, 128, 128, 1)

2025-11-08 21:27:10,263 - fedguard_client - WARNING - Training failed or OOM. Training time: 0.15s
2025-11-08 21:27:11,629 - fedguard_client - INFO - Sending update to Kafka topic: 'model-updates' (payload size: 6508784 bytes, status: training_failed)...
2025-11-08 21:27:13,915 - fedguard_client - INFO - [OK] Update sent successfully (Send time: 2.28s)
2025-11-08 21:27:13,916 - fedguard_client - INFO - Total updates sent: 21
2025-11-08 21:27:13,916 - fedguard_client - INFO - Avg training time: 0.14s
2025-11-08 21:27:14,154 - fedguard_client - INFO - 
[Update #22] Collected 16 frames
2025-11-08 21:27:14,174 - fedguard_client - INFO - Performing local training...
2025-11-08 21:27:14,305 - fedguard_client - ERROR - Unexpected error during training
Traceback (most recent call last):
  File "C:\Users\Nandini Devi\FedGuard-Project\federated\federated_client.py", line 162, in main
    history = model.fit(
  File "C:\Users\Nandini Devi\FedGuard-Project\venv\lib\site-packages\keras\src\utils\traceback_utils.py", line 70, in error_handler
    raise e.with_traceback(filtered_tb) from None
  File "C:\Users\NANDIN~1\AppData\Local\Temp\__autograph_generated_filej6f9loxk.py", line 15, in tf__train_function
    retval_ = ag__.converted_call(ag__.ld(step_function), (ag__.ld(self), ag__.ld(iterator)), None, fscope)
ValueError: in user code:

    File "C:\Users\Nandini Devi\FedGuard-Project\venv\lib\site-packages\keras\src\engine\training.py", line 1338, in train_function  *
        return step_function(self, iterator)
    File "C:\Users\Nandini Devi\FedGuard-Project\venv\lib\site-packages\keras\src\engine\training.py", line 1322, in step_function  **
        outputs = model.distribute_strategy.run(run_step, args=(data,))
    File "C:\Users\Nandini Devi\FedGuard-Project\venv\lib\site-packages\keras\src\engine\training.py", line 1303, in run_step  **
        outputs = model.train_step(data)
    File "C:\Users\Nandini Devi\FedGuard-Project\venv\lib\site-packages\keras\src\engine\training.py", line 1080, in train_step
        y_pred = self(x, training=True)
    File "C:\Users\Nandini Devi\FedGuard-Project\venv\lib\site-packages\keras\src\utils\traceback_utils.py", line 70, in error_handler
        raise e.with_traceback(filtered_tb) from None
    File "C:\Users\Nandini Devi\FedGuard-Project\venv\lib\site-packages\keras\src\engine\input_spec.py", line 298, in assert_input_compatibility
        raise ValueError(

    ValueError: Input 0 of layer "autoencoder" is incompatible with the layer: expected shape=(None, 256, 256, 1), found shape=(8, 128, 128, 1)

2025-11-08 21:27:14,307 - fedguard_client - WARNING - Training failed or OOM. Training time: 0.13s
2025-11-08 21:27:15,739 - fedguard_client - INFO - Sending update to Kafka topic: 'model-updates' (payload size: 6508784 bytes, status: training_failed)...
2025-11-08 21:27:18,465 - fedguard_client - INFO - [OK] Update sent successfully (Send time: 2.72s)
2025-11-08 21:27:18,478 - fedguard_client - INFO - Total updates sent: 22
2025-11-08 21:27:18,480 - fedguard_client - INFO - Avg training time: 0.14s
2025-11-08 21:27:18,731 - fedguard_client - INFO - 
[Update #23] Collected 16 frames
2025-11-08 21:27:18,732 - fedguard_client - INFO - Performing local training...
2025-11-08 21:27:18,835 - fedguard_client - ERROR - Unexpected error during training
Traceback (most recent call last):
  File "C:\Users\Nandini Devi\FedGuard-Project\federated\federated_client.py", line 162, in main
    history = model.fit(
  File "C:\Users\Nandini Devi\FedGuard-Project\venv\lib\site-packages\keras\src\utils\traceback_utils.py", line 70, in error_handler
    raise e.with_traceback(filtered_tb) from None
  File "C:\Users\NANDIN~1\AppData\Local\Temp\__autograph_generated_filej6f9loxk.py", line 15, in tf__train_function
    retval_ = ag__.converted_call(ag__.ld(step_function), (ag__.ld(self), ag__.ld(iterator)), None, fscope)
ValueError: in user code:

    File "C:\Users\Nandini Devi\FedGuard-Project\venv\lib\site-packages\keras\src\engine\training.py", line 1338, in train_function  *
        return step_function(self, iterator)
    File "C:\Users\Nandini Devi\FedGuard-Project\venv\lib\site-packages\keras\src\engine\training.py", line 1322, in step_function  **
        outputs = model.distribute_strategy.run(run_step, args=(data,))
    File "C:\Users\Nandini Devi\FedGuard-Project\venv\lib\site-packages\keras\src\engine\training.py", line 1303, in run_step  **
        outputs = model.train_step(data)
    File "C:\Users\Nandini Devi\FedGuard-Project\venv\lib\site-packages\keras\src\engine\training.py", line 1080, in train_step
        y_pred = self(x, training=True)
    File "C:\Users\Nandini Devi\FedGuard-Project\venv\lib\site-packages\keras\src\utils\traceback_utils.py", line 70, in error_handler
        raise e.with_traceback(filtered_tb) from None
    File "C:\Users\Nandini Devi\FedGuard-Project\venv\lib\site-packages\keras\src\engine\input_spec.py", line 298, in assert_input_compatibility
        raise ValueError(

    ValueError: Input 0 of layer "autoencoder" is incompatible with the layer: expected shape=(None, 256, 256, 1), found shape=(8, 128, 128, 1)

2025-11-08 21:27:18,835 - fedguard_client - WARNING - Training failed or OOM. Training time: 0.10s
2025-11-08 21:27:20,109 - fedguard_client - INFO - Sending update to Kafka topic: 'model-updates' (payload size: 6508784 bytes, status: training_failed)...
2025-11-08 21:27:23,394 - fedguard_client - INFO - [OK] Update sent successfully (Send time: 3.28s)
2025-11-08 21:27:23,395 - fedguard_client - INFO - Total updates sent: 23
2025-11-08 21:27:23,396 - fedguard_client - INFO - Avg training time: 0.14s
2025-11-08 21:27:23,645 - fedguard_client - INFO - 
[Update #24] Collected 16 frames
2025-11-08 21:27:23,645 - fedguard_client - INFO - Performing local training...
2025-11-08 21:27:23,783 - fedguard_client - ERROR - Unexpected error during training
Traceback (most recent call last):
  File "C:\Users\Nandini Devi\FedGuard-Project\federated\federated_client.py", line 162, in main
    history = model.fit(
  File "C:\Users\Nandini Devi\FedGuard-Project\venv\lib\site-packages\keras\src\utils\traceback_utils.py", line 70, in error_handler
    raise e.with_traceback(filtered_tb) from None
  File "C:\Users\NANDIN~1\AppData\Local\Temp\__autograph_generated_filej6f9loxk.py", line 15, in tf__train_function
    retval_ = ag__.converted_call(ag__.ld(step_function), (ag__.ld(self), ag__.ld(iterator)), None, fscope)
ValueError: in user code:

    File "C:\Users\Nandini Devi\FedGuard-Project\venv\lib\site-packages\keras\src\engine\training.py", line 1338, in train_function  *
        return step_function(self, iterator)
    File "C:\Users\Nandini Devi\FedGuard-Project\venv\lib\site-packages\keras\src\engine\training.py", line 1322, in step_function  **
        outputs = model.distribute_strategy.run(run_step, args=(data,))
    File "C:\Users\Nandini Devi\FedGuard-Project\venv\lib\site-packages\keras\src\engine\training.py", line 1303, in run_step  **
        outputs = model.train_step(data)
    File "C:\Users\Nandini Devi\FedGuard-Project\venv\lib\site-packages\keras\src\engine\training.py", line 1080, in train_step
        y_pred = self(x, training=True)
    File "C:\Users\Nandini Devi\FedGuard-Project\venv\lib\site-packages\keras\src\utils\traceback_utils.py", line 70, in error_handler
        raise e.with_traceback(filtered_tb) from None
    File "C:\Users\Nandini Devi\FedGuard-Project\venv\lib\site-packages\keras\src\engine\input_spec.py", line 298, in assert_input_compatibility
        raise ValueError(

    ValueError: Input 0 of layer "autoencoder" is incompatible with the layer: expected shape=(None, 256, 256, 1), found shape=(8, 128, 128, 1)

2025-11-08 21:27:23,813 - fedguard_client - WARNING - Training failed or OOM. Training time: 0.17s
2025-11-08 21:27:25,216 - fedguard_client - INFO - Sending update to Kafka topic: 'model-updates' (payload size: 6508784 bytes, status: training_failed)...
2025-11-08 21:27:28,149 - fedguard_client - INFO - [OK] Update sent successfully (Send time: 2.93s)
2025-11-08 21:27:28,150 - fedguard_client - INFO - Total updates sent: 24
2025-11-08 21:27:28,151 - fedguard_client - INFO - Avg training time: 0.14s
2025-11-08 21:27:28,386 - fedguard_client - INFO - 
[Update #25] Collected 16 frames
2025-11-08 21:27:28,387 - fedguard_client - INFO - Performing local training...
2025-11-08 21:27:28,495 - fedguard_client - ERROR - Unexpected error during training
Traceback (most recent call last):
  File "C:\Users\Nandini Devi\FedGuard-Project\federated\federated_client.py", line 162, in main
    history = model.fit(
  File "C:\Users\Nandini Devi\FedGuard-Project\venv\lib\site-packages\keras\src\utils\traceback_utils.py", line 70, in error_handler
    raise e.with_traceback(filtered_tb) from None
  File "C:\Users\NANDIN~1\AppData\Local\Temp\__autograph_generated_filej6f9loxk.py", line 15, in tf__train_function
    retval_ = ag__.converted_call(ag__.ld(step_function), (ag__.ld(self), ag__.ld(iterator)), None, fscope)
ValueError: in user code:

    File "C:\Users\Nandini Devi\FedGuard-Project\venv\lib\site-packages\keras\src\engine\training.py", line 1338, in train_function  *
        return step_function(self, iterator)
    File "C:\Users\Nandini Devi\FedGuard-Project\venv\lib\site-packages\keras\src\engine\training.py", line 1322, in step_function  **
        outputs = model.distribute_strategy.run(run_step, args=(data,))
    File "C:\Users\Nandini Devi\FedGuard-Project\venv\lib\site-packages\keras\src\engine\training.py", line 1303, in run_step  **
        outputs = model.train_step(data)
    File "C:\Users\Nandini Devi\FedGuard-Project\venv\lib\site-packages\keras\src\engine\training.py", line 1080, in train_step
        y_pred = self(x, training=True)
    File "C:\Users\Nandini Devi\FedGuard-Project\venv\lib\site-packages\keras\src\utils\traceback_utils.py", line 70, in error_handler
        raise e.with_traceback(filtered_tb) from None
    File "C:\Users\Nandini Devi\FedGuard-Project\venv\lib\site-packages\keras\src\engine\input_spec.py", line 298, in assert_input_compatibility
        raise ValueError(

    ValueError: Input 0 of layer "autoencoder" is incompatible with the layer: expected shape=(None, 256, 256, 1), found shape=(8, 128, 128, 1)

2025-11-08 21:27:28,497 - fedguard_client - WARNING - Training failed or OOM. Training time: 0.11s
2025-11-08 21:27:29,569 - fedguard_client - INFO - Sending update to Kafka topic: 'model-updates' (payload size: 6508784 bytes, status: training_failed)...
2025-11-08 21:27:32,630 - fedguard_client - INFO - [OK] Update sent successfully (Send time: 3.06s)
2025-11-08 21:27:32,631 - fedguard_client - INFO - Total updates sent: 25
2025-11-08 21:27:32,631 - fedguard_client - INFO - Avg training time: 0.14s
2025-11-08 21:27:32,881 - fedguard_client - INFO - 
[Update #26] Collected 16 frames
2025-11-08 21:27:32,883 - fedguard_client - INFO - Performing local training...
2025-11-08 21:27:33,035 - fedguard_client - ERROR - Unexpected error during training
Traceback (most recent call last):
  File "C:\Users\Nandini Devi\FedGuard-Project\federated\federated_client.py", line 162, in main
    history = model.fit(
  File "C:\Users\Nandini Devi\FedGuard-Project\venv\lib\site-packages\keras\src\utils\traceback_utils.py", line 70, in error_handler
    raise e.with_traceback(filtered_tb) from None
  File "C:\Users\NANDIN~1\AppData\Local\Temp\__autograph_generated_filej6f9loxk.py", line 15, in tf__train_function
    retval_ = ag__.converted_call(ag__.ld(step_function), (ag__.ld(self), ag__.ld(iterator)), None, fscope)
ValueError: in user code:

    File "C:\Users\Nandini Devi\FedGuard-Project\venv\lib\site-packages\keras\src\engine\training.py", line 1338, in train_function  *
        return step_function(self, iterator)
    File "C:\Users\Nandini Devi\FedGuard-Project\venv\lib\site-packages\keras\src\engine\training.py", line 1322, in step_function  **
        outputs = model.distribute_strategy.run(run_step, args=(data,))
    File "C:\Users\Nandini Devi\FedGuard-Project\venv\lib\site-packages\keras\src\engine\training.py", line 1303, in run_step  **
        outputs = model.train_step(data)
    File "C:\Users\Nandini Devi\FedGuard-Project\venv\lib\site-packages\keras\src\engine\training.py", line 1080, in train_step
        y_pred = self(x, training=True)
    File "C:\Users\Nandini Devi\FedGuard-Project\venv\lib\site-packages\keras\src\utils\traceback_utils.py", line 70, in error_handler
        raise e.with_traceback(filtered_tb) from None
    File "C:\Users\Nandini Devi\FedGuard-Project\venv\lib\site-packages\keras\src\engine\input_spec.py", line 298, in assert_input_compatibility
        raise ValueError(

    ValueError: Input 0 of layer "autoencoder" is incompatible with the layer: expected shape=(None, 256, 256, 1), found shape=(8, 128, 128, 1)

2025-11-08 21:27:33,035 - fedguard_client - WARNING - Training failed or OOM. Training time: 0.15s
2025-11-08 21:27:34,463 - fedguard_client - INFO - Sending update to Kafka topic: 'model-updates' (payload size: 6508784 bytes, status: training_failed)...
2025-11-08 21:27:37,032 - fedguard_client - INFO - [OK] Update sent successfully (Send time: 2.57s)
2025-11-08 21:27:37,036 - fedguard_client - INFO - Total updates sent: 26
2025-11-08 21:27:37,037 - fedguard_client - INFO - Avg training time: 0.14s
2025-11-08 21:27:37,312 - fedguard_client - INFO - 
[Update #27] Collected 16 frames
2025-11-08 21:27:37,314 - fedguard_client - INFO - Performing local training...
2025-11-08 21:27:37,439 - fedguard_client - ERROR - Unexpected error during training
Traceback (most recent call last):
  File "C:\Users\Nandini Devi\FedGuard-Project\federated\federated_client.py", line 162, in main
    history = model.fit(
  File "C:\Users\Nandini Devi\FedGuard-Project\venv\lib\site-packages\keras\src\utils\traceback_utils.py", line 70, in error_handler
    raise e.with_traceback(filtered_tb) from None
  File "C:\Users\NANDIN~1\AppData\Local\Temp\__autograph_generated_filej6f9loxk.py", line 15, in tf__train_function
    retval_ = ag__.converted_call(ag__.ld(step_function), (ag__.ld(self), ag__.ld(iterator)), None, fscope)
ValueError: in user code:

    File "C:\Users\Nandini Devi\FedGuard-Project\venv\lib\site-packages\keras\src\engine\training.py", line 1338, in train_function  *
        return step_function(self, iterator)
    File "C:\Users\Nandini Devi\FedGuard-Project\venv\lib\site-packages\keras\src\engine\training.py", line 1322, in step_function  **
        outputs = model.distribute_strategy.run(run_step, args=(data,))
    File "C:\Users\Nandini Devi\FedGuard-Project\venv\lib\site-packages\keras\src\engine\training.py", line 1303, in run_step  **
        outputs = model.train_step(data)
    File "C:\Users\Nandini Devi\FedGuard-Project\venv\lib\site-packages\keras\src\engine\training.py", line 1080, in train_step
        y_pred = self(x, training=True)
    File "C:\Users\Nandini Devi\FedGuard-Project\venv\lib\site-packages\keras\src\utils\traceback_utils.py", line 70, in error_handler
        raise e.with_traceback(filtered_tb) from None
    File "C:\Users\Nandini Devi\FedGuard-Project\venv\lib\site-packages\keras\src\engine\input_spec.py", line 298, in assert_input_compatibility
        raise ValueError(

    ValueError: Input 0 of layer "autoencoder" is incompatible with the layer: expected shape=(None, 256, 256, 1), found shape=(8, 128, 128, 1)

2025-11-08 21:27:37,441 - fedguard_client - WARNING - Training failed or OOM. Training time: 0.13s
2025-11-08 21:27:38,616 - fedguard_client - INFO - Sending update to Kafka topic: 'model-updates' (payload size: 6508784 bytes, status: training_failed)...
2025-11-08 21:27:39,630 - fedguard_client - ERROR - Failed to send update to Kafka: 
Traceback (most recent call last):
  File "C:\Users\Nandini Devi\FedGuard-Project\federated\federated_client.py", line 233, in main
    producer.send(
  File "C:\Users\Nandini Devi\FedGuard-Project\venv\lib\site-packages\kafka\producer\kafka.py", line 600, in send
    result = self._accumulator.append(tp, timestamp_ms,
  File "C:\Users\Nandini Devi\FedGuard-Project\venv\lib\site-packages\kafka\producer\record_accumulator.py", line 266, in append
    future = batch.try_append(timestamp_ms, key, value, headers)
  File "C:\Users\Nandini Devi\FedGuard-Project\venv\lib\site-packages\kafka\producer\record_accumulator.py", line 58, in try_append
    metadata = self.records.append(timestamp_ms, key, value, headers)
  File "C:\Users\Nandini Devi\FedGuard-Project\venv\lib\site-packages\kafka\record\memory_records.py", line 146, in append
    metadata = self._builder.append(offset, timestamp, key, value, headers)
  File "C:\Users\Nandini Devi\FedGuard-Project\venv\lib\site-packages\kafka\record\default_records.py", line 457, in append
    write(value)
MemoryError
2025-11-08 21:27:39,767 - fedguard_client - INFO - Total updates sent: 27
2025-11-08 21:27:39,768 - fedguard_client - INFO - Avg training time: 0.14s
2025-11-08 21:27:39,991 - fedguard_client - INFO - 
[Update #28] Collected 16 frames
2025-11-08 21:27:39,993 - fedguard_client - INFO - Performing local training...
2025-11-08 21:27:41,004 - fedguard_client - ERROR - Unexpected error during training
Traceback (most recent call last):
  File "C:\Users\Nandini Devi\FedGuard-Project\federated\federated_client.py", line 162, in main
    history = model.fit(
  File "C:\Users\Nandini Devi\FedGuard-Project\venv\lib\site-packages\keras\src\utils\traceback_utils.py", line 70, in error_handler
    raise e.with_traceback(filtered_tb) from None
  File "C:\Users\Nandini Devi\FedGuard-Project\venv\lib\site-packages\tensorflow\python\framework\constant_op.py", line 86, in convert_to_eager_tensor
    value = value.copy()
numpy.core._exceptions._ArrayMemoryError: Unable to allocate 1.00 MiB for an array with shape (16, 128, 128, 1) and data type float32
2025-11-08 21:27:41,112 - fedguard_client - WARNING - Training failed or OOM. Training time: 1.12s
2025-11-08 21:27:42,552 - fedguard_client - ERROR - Failed to extract/serialize weights: Unable to allocate output buffer.
Traceback (most recent call last):
  File "C:\Users\Nandini Devi\FedGuard-Project\federated\federated_client.py", line 217, in main
    payload_bytes = serialize_weights_to_bytes(new_weights)
  File "C:\Users\Nandini Devi\FedGuard-Project\federated\federated_client.py", line 47, in serialize_weights_to_bytes
    np.savez_compressed(buf, **savez_dict)
  File "<__array_function__ internals>", line 200, in savez_compressed
  File "C:\Users\Nandini Devi\FedGuard-Project\venv\lib\site-packages\numpy\lib\npyio.py", line 686, in savez_compressed
    _savez(file, args, kwds, True)
  File "C:\Users\Nandini Devi\FedGuard-Project\venv\lib\site-packages\numpy\lib\npyio.py", line 719, in _savez
    format.write_array(fid, val,
  File "C:\Users\Nandini Devi\FedGuard-Project\venv\lib\site-packages\numpy\lib\format.py", line 727, in write_array
    fp.write(chunk.tobytes('C'))
  File "C:\Users\Nandini Devi\AppData\Local\Programs\Python\Python310\lib\zipfile.py", line 1139, in write
    data = self._compressor.compress(data)
MemoryError: Unable to allocate output buffer.
2025-11-08 21:27:42,835 - fedguard_client - INFO - Sending update to Kafka topic: 'model-updates' (payload size: 0 bytes, status: training_failed)...
2025-11-08 21:27:42,855 - fedguard_client - INFO - [OK] Update sent successfully (Send time: 0.02s)
2025-11-08 21:27:42,855 - fedguard_client - INFO - Total updates sent: 28
2025-11-08 21:27:42,856 - fedguard_client - INFO - Avg training time: 0.17s
2025-11-08 21:27:43,096 - fedguard_client - INFO - 
[Update #29] Collected 16 frames
2025-11-08 21:27:44,126 - fedguard_client - ERROR - FATAL ERROR (client): Unable to allocate 1.00 MiB for an array with shape (16, 128, 128) and data type float32
Traceback (most recent call last):
  File "C:\Users\Nandini Devi\FedGuard-Project\federated\federated_client.py", line 128, in main
    train_data = np.array(frames_batch)
numpy.core._exceptions._ArrayMemoryError: Unable to allocate 1.00 MiB for an array with shape (16, 128, 128) and data type float32
2025-11-08 21:27:44,145 - fedguard_client - INFO - Cleaning up client...
2025-11-08 21:27:44,170 - kafka.producer.kafka - INFO - Closing the Kafka producer with 4294967.0 secs timeout.
2025-11-08 21:27:44,171 - kafka.conn - INFO - <BrokerConnection node_id=1 host=localhost:9092 <connected> [IPv6 ('::1', 9092, 0, 0)]>: Closing connection. 
2025-11-08 21:27:44,171 - fedguard_client - INFO - Client Client-01 shut down successfully
