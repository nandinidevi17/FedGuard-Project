2025-12-01 13:20:00,895 - __main__ - INFO - 
FEDGUARD MODEL COMPARISON
2025-12-01 13:20:00,897 - __main__ - INFO - 
============================================================
2025-12-01 13:20:00,897 - __main__ - INFO - Evaluating: FedGuard (Secure)
2025-12-01 13:20:00,897 - __main__ - INFO - Model path: C:\Users\Nandini Devi\FedGuard-Project\results\models\global_model_secured.h5
2025-12-01 13:20:00,897 - __main__ - INFO - Test folder: C:\Users\Nandini Devi\Downloads\uropds\UCSD_Anomaly_Dataset.v1p2\UCSDped1\Test\Test001
2025-12-01 13:20:01,724 - __main__ - INFO - ✓ Model loaded successfully
2025-12-01 13:20:02,317 - utils.data_loader - INFO - Loaded 200 test frames from C:\Users\Nandini Devi\Downloads\uropds\UCSD_Anomaly_Dataset.v1p2\UCSDped1\Test\Test001
2025-12-01 13:20:02,320 - __main__ - INFO - ✓ Loaded 200 frames
2025-12-01 13:20:02,322 - utils.data_loader - WARNING - Ground truth not found at C:\Users\Nandini Devi\Downloads\uropds\UCSD_Anomaly_Dataset.v1p2\UCSDped1\Test\Test001_gt
2025-12-01 13:20:02,328 - __main__ - INFO - ✓ Ground truth loaded (0 anomalies)
2025-12-01 13:20:02,329 - __main__ - INFO - Calculating reconstruction errors...
2025-12-01 13:20:06,995 - __main__ - INFO - ✓ Reconstruction errors calculated
2025-12-01 13:20:07,003 - utils.metrics - WARNING - Could not calculate ROC-AUC (ground truth contains a single class). Returning auc=None.
2025-12-01 13:20:07,003 - __main__ - INFO - 
RESULTS
2025-12-01 13:20:07,004 - __main__ - INFO - Threshold (MSE): 0.003946
2025-12-01 13:20:07,004 - __main__ - INFO - Accuracy: 95.00%
2025-12-01 13:20:07,005 - __main__ - INFO - Precision: 0.00%
2025-12-01 13:20:07,005 - __main__ - INFO - Recall: 0.00%
2025-12-01 13:20:07,006 - __main__ - INFO - F1-Score: 0.0000
2025-12-01 13:20:07,006 - __main__ - INFO - AUC-ROC: N/A
2025-12-01 13:20:07,009 - __main__ - INFO - 
============================================================
2025-12-01 13:20:07,010 - __main__ - INFO - Evaluating: Attacked (No Defense)
2025-12-01 13:20:07,010 - __main__ - INFO - Model path: C:\Users\Nandini Devi\FedGuard-Project\results\models\global_model_insecured.h5
2025-12-01 13:20:07,011 - __main__ - INFO - Test folder: C:\Users\Nandini Devi\Downloads\uropds\UCSD_Anomaly_Dataset.v1p2\UCSDped1\Test\Test001
2025-12-01 13:20:07,020 - __main__ - ERROR - Failed to load model: Error when deserializing class 'InputLayer' using config={'batch_shape': [None, 256, 256, 1], 'dtype': 'float32', 'sparse': False, 'ragged': False, 'name': 'input_layer'}.

Exception encountered: Unrecognized keyword arguments: ['batch_shape']
2025-12-01 13:20:07,021 - __main__ - ERROR - Failed to evaluate attacked model
2025-12-01 13:22:15,715 - __main__ - INFO - 
FEDGUARD MODEL COMPARISON
2025-12-01 13:22:15,716 - __main__ - INFO - 
============================================================
2025-12-01 13:22:15,716 - __main__ - INFO - Evaluating: FedGuard (Secure)
2025-12-01 13:22:15,716 - __main__ - INFO - Model path: C:\Users\Nandini Devi\FedGuard-Project\results\models\global_model_secured.h5
2025-12-01 13:22:15,716 - __main__ - INFO - Test folder: C:\Users\Nandini Devi\Downloads\uropds\UCSD_Anomaly_Dataset.v1p2\UCSDped1\Test\Test001
2025-12-01 13:22:16,118 - __main__ - INFO - ✓ Model loaded successfully (direct)
2025-12-01 13:22:16,192 - utils.data_loader - INFO - Loaded 200 test frames from C:\Users\Nandini Devi\Downloads\uropds\UCSD_Anomaly_Dataset.v1p2\UCSDped1\Test\Test001
2025-12-01 13:22:16,192 - __main__ - INFO - ✓ Loaded 200 frames
2025-12-01 13:22:16,193 - utils.data_loader - WARNING - Ground truth not found at C:\Users\Nandini Devi\Downloads\uropds\UCSD_Anomaly_Dataset.v1p2\UCSDped1\Test\Test001_gt
2025-12-01 13:22:16,195 - __main__ - INFO - ✓ Ground truth loaded (0 anomalies)
2025-12-01 13:22:16,196 - __main__ - INFO - Calculating reconstruction errors...
2025-12-01 13:22:19,595 - __main__ - INFO - ✓ Reconstruction errors calculated
2025-12-01 13:22:19,600 - __main__ - INFO - 
RESULTS
2025-12-01 13:22:19,601 - __main__ - INFO - Threshold (MSE): 0.003946
2025-12-01 13:22:19,601 - __main__ - INFO - Accuracy: 95.00%
2025-12-01 13:22:19,602 - __main__ - INFO - Precision: 0.00%
2025-12-01 13:22:19,602 - __main__ - INFO - Recall: 0.00%
2025-12-01 13:22:19,603 - __main__ - INFO - F1-Score: 0.0000
2025-12-01 13:22:19,604 - __main__ - INFO - AUC-ROC: N/A
2025-12-01 13:22:19,604 - __main__ - INFO - 
Confusion Matrix:
2025-12-01 13:22:19,605 - __main__ - INFO -   TP: 0, TN: 190
2025-12-01 13:22:19,605 - __main__ - INFO -   FP: 10, FN: 0
2025-12-01 13:22:19,606 - __main__ - INFO - 
============================================================
2025-12-01 13:22:19,606 - __main__ - INFO - Evaluating: Attacked (No Defense)
2025-12-01 13:22:19,607 - __main__ - INFO - Model path: C:\Users\Nandini Devi\FedGuard-Project\results\models\global_model_insecured.h5
2025-12-01 13:22:19,607 - __main__ - INFO - Test folder: C:\Users\Nandini Devi\Downloads\uropds\UCSD_Anomaly_Dataset.v1p2\UCSDped1\Test\Test001
2025-12-01 13:22:19,611 - __main__ - WARNING - Direct load failed: Error when deserializing class 'InputLayer' using config={'batch_shape': [None, 256, 256, 1], 'dtype': 'float32', 'sparse': False, 'ragged': False, 'name': 'input_layer'}.

Exception encountered: Unrecognized keyword arguments: ['batch_shape']
2025-12-01 13:22:19,615 - __main__ - WARNING - Load with compile=False failed: Error when deserializing class 'InputLayer' using config={'batch_shape': [None, 256, 256, 1], 'dtype': 'float32', 'sparse': False, 'ragged': False, 'name': 'input_layer'}.

Exception encountered: Unrecognized keyword arguments: ['batch_shape']
2025-12-01 13:22:19,620 - __main__ - WARNING - Load with custom objects failed: Error when deserializing class 'InputLayer' using config={'batch_shape': [None, 256, 256, 1], 'dtype': 'float32', 'sparse': False, 'ragged': False, 'name': 'input_layer'}.

Exception encountered: Unrecognized keyword arguments: ['batch_shape']
2025-12-01 13:22:19,622 - __main__ - INFO - Attempting to recreate model architecture and load weights...
2025-12-01 13:22:19,907 - __main__ - WARNING - Load weights failed: Layer count mismatch when loading weights from file. Model expected 15 layers, found 5 saved layers.
2025-12-01 13:22:19,907 - __main__ - ERROR - All model loading strategies failed for C:\Users\Nandini Devi\FedGuard-Project\results\models\global_model_insecured.h5
2025-12-01 13:22:19,908 - __main__ - ERROR - Failed to load model: C:\Users\Nandini Devi\FedGuard-Project\results\models\global_model_insecured.h5
2025-12-01 13:22:19,908 - __main__ - ERROR - Failed to evaluate attacked model
