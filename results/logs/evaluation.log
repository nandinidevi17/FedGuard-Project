2025-12-01 13:20:00,895 - __main__ - INFO - 
FEDGUARD MODEL COMPARISON
2025-12-01 13:20:00,897 - __main__ - INFO - 
============================================================
2025-12-01 13:20:00,897 - __main__ - INFO - Evaluating: FedGuard (Secure)
2025-12-01 13:20:00,897 - __main__ - INFO - Model path: C:\Users\Nandini Devi\FedGuard-Project\results\models\global_model_secured.h5
2025-12-01 13:20:00,897 - __main__ - INFO - Test folder: C:\Users\Nandini Devi\Downloads\uropds\UCSD_Anomaly_Dataset.v1p2\UCSDped1\Test\Test001
2025-12-01 13:20:01,724 - __main__ - INFO - ✓ Model loaded successfully
2025-12-01 13:20:02,317 - utils.data_loader - INFO - Loaded 200 test frames from C:\Users\Nandini Devi\Downloads\uropds\UCSD_Anomaly_Dataset.v1p2\UCSDped1\Test\Test001
2025-12-01 13:20:02,320 - __main__ - INFO - ✓ Loaded 200 frames
2025-12-01 13:20:02,322 - utils.data_loader - WARNING - Ground truth not found at C:\Users\Nandini Devi\Downloads\uropds\UCSD_Anomaly_Dataset.v1p2\UCSDped1\Test\Test001_gt
2025-12-01 13:20:02,328 - __main__ - INFO - ✓ Ground truth loaded (0 anomalies)
2025-12-01 13:20:02,329 - __main__ - INFO - Calculating reconstruction errors...
2025-12-01 13:20:06,995 - __main__ - INFO - ✓ Reconstruction errors calculated
2025-12-01 13:20:07,003 - utils.metrics - WARNING - Could not calculate ROC-AUC (ground truth contains a single class). Returning auc=None.
2025-12-01 13:20:07,003 - __main__ - INFO - 
RESULTS
2025-12-01 13:20:07,004 - __main__ - INFO - Threshold (MSE): 0.003946
2025-12-01 13:20:07,004 - __main__ - INFO - Accuracy: 95.00%
2025-12-01 13:20:07,005 - __main__ - INFO - Precision: 0.00%
2025-12-01 13:20:07,005 - __main__ - INFO - Recall: 0.00%
2025-12-01 13:20:07,006 - __main__ - INFO - F1-Score: 0.0000
2025-12-01 13:20:07,006 - __main__ - INFO - AUC-ROC: N/A
2025-12-01 13:20:07,009 - __main__ - INFO - 
============================================================
2025-12-01 13:20:07,010 - __main__ - INFO - Evaluating: Attacked (No Defense)
2025-12-01 13:20:07,010 - __main__ - INFO - Model path: C:\Users\Nandini Devi\FedGuard-Project\results\models\global_model_insecured.h5
2025-12-01 13:20:07,011 - __main__ - INFO - Test folder: C:\Users\Nandini Devi\Downloads\uropds\UCSD_Anomaly_Dataset.v1p2\UCSDped1\Test\Test001
2025-12-01 13:20:07,020 - __main__ - ERROR - Failed to load model: Error when deserializing class 'InputLayer' using config={'batch_shape': [None, 256, 256, 1], 'dtype': 'float32', 'sparse': False, 'ragged': False, 'name': 'input_layer'}.

Exception encountered: Unrecognized keyword arguments: ['batch_shape']
2025-12-01 13:20:07,021 - __main__ - ERROR - Failed to evaluate attacked model
2025-12-01 13:22:15,715 - __main__ - INFO - 
FEDGUARD MODEL COMPARISON
2025-12-01 13:22:15,716 - __main__ - INFO - 
============================================================
2025-12-01 13:22:15,716 - __main__ - INFO - Evaluating: FedGuard (Secure)
2025-12-01 13:22:15,716 - __main__ - INFO - Model path: C:\Users\Nandini Devi\FedGuard-Project\results\models\global_model_secured.h5
2025-12-01 13:22:15,716 - __main__ - INFO - Test folder: C:\Users\Nandini Devi\Downloads\uropds\UCSD_Anomaly_Dataset.v1p2\UCSDped1\Test\Test001
2025-12-01 13:22:16,118 - __main__ - INFO - ✓ Model loaded successfully (direct)
2025-12-01 13:22:16,192 - utils.data_loader - INFO - Loaded 200 test frames from C:\Users\Nandini Devi\Downloads\uropds\UCSD_Anomaly_Dataset.v1p2\UCSDped1\Test\Test001
2025-12-01 13:22:16,192 - __main__ - INFO - ✓ Loaded 200 frames
2025-12-01 13:22:16,193 - utils.data_loader - WARNING - Ground truth not found at C:\Users\Nandini Devi\Downloads\uropds\UCSD_Anomaly_Dataset.v1p2\UCSDped1\Test\Test001_gt
2025-12-01 13:22:16,195 - __main__ - INFO - ✓ Ground truth loaded (0 anomalies)
2025-12-01 13:22:16,196 - __main__ - INFO - Calculating reconstruction errors...
2025-12-01 13:22:19,595 - __main__ - INFO - ✓ Reconstruction errors calculated
2025-12-01 13:22:19,600 - __main__ - INFO - 
RESULTS
2025-12-01 13:22:19,601 - __main__ - INFO - Threshold (MSE): 0.003946
2025-12-01 13:22:19,601 - __main__ - INFO - Accuracy: 95.00%
2025-12-01 13:22:19,602 - __main__ - INFO - Precision: 0.00%
2025-12-01 13:22:19,602 - __main__ - INFO - Recall: 0.00%
2025-12-01 13:22:19,603 - __main__ - INFO - F1-Score: 0.0000
2025-12-01 13:22:19,604 - __main__ - INFO - AUC-ROC: N/A
2025-12-01 13:22:19,604 - __main__ - INFO - 
Confusion Matrix:
2025-12-01 13:22:19,605 - __main__ - INFO -   TP: 0, TN: 190
2025-12-01 13:22:19,605 - __main__ - INFO -   FP: 10, FN: 0
2025-12-01 13:22:19,606 - __main__ - INFO - 
============================================================
2025-12-01 13:22:19,606 - __main__ - INFO - Evaluating: Attacked (No Defense)
2025-12-01 13:22:19,607 - __main__ - INFO - Model path: C:\Users\Nandini Devi\FedGuard-Project\results\models\global_model_insecured.h5
2025-12-01 13:22:19,607 - __main__ - INFO - Test folder: C:\Users\Nandini Devi\Downloads\uropds\UCSD_Anomaly_Dataset.v1p2\UCSDped1\Test\Test001
2025-12-01 13:22:19,611 - __main__ - WARNING - Direct load failed: Error when deserializing class 'InputLayer' using config={'batch_shape': [None, 256, 256, 1], 'dtype': 'float32', 'sparse': False, 'ragged': False, 'name': 'input_layer'}.

Exception encountered: Unrecognized keyword arguments: ['batch_shape']
2025-12-01 13:22:19,615 - __main__ - WARNING - Load with compile=False failed: Error when deserializing class 'InputLayer' using config={'batch_shape': [None, 256, 256, 1], 'dtype': 'float32', 'sparse': False, 'ragged': False, 'name': 'input_layer'}.

Exception encountered: Unrecognized keyword arguments: ['batch_shape']
2025-12-01 13:22:19,620 - __main__ - WARNING - Load with custom objects failed: Error when deserializing class 'InputLayer' using config={'batch_shape': [None, 256, 256, 1], 'dtype': 'float32', 'sparse': False, 'ragged': False, 'name': 'input_layer'}.

Exception encountered: Unrecognized keyword arguments: ['batch_shape']
2025-12-01 13:22:19,622 - __main__ - INFO - Attempting to recreate model architecture and load weights...
2025-12-01 13:22:19,907 - __main__ - WARNING - Load weights failed: Layer count mismatch when loading weights from file. Model expected 15 layers, found 5 saved layers.
2025-12-01 13:22:19,907 - __main__ - ERROR - All model loading strategies failed for C:\Users\Nandini Devi\FedGuard-Project\results\models\global_model_insecured.h5
2025-12-01 13:22:19,908 - __main__ - ERROR - Failed to load model: C:\Users\Nandini Devi\FedGuard-Project\results\models\global_model_insecured.h5
2025-12-01 13:22:19,908 - __main__ - ERROR - Failed to evaluate attacked model
2025-12-01 16:01:12,478 - __main__ - INFO - 
FEDGUARD MODEL COMPARISON
2025-12-01 16:01:12,480 - __main__ - INFO - 
============================================================
2025-12-01 16:01:12,480 - __main__ - INFO - Evaluating: FedGuard (Secure)
2025-12-01 16:01:12,480 - __main__ - INFO - Model path: C:\Users\Nandini Devi\FedGuard-Project\results\models\global_model_secured.h5
2025-12-01 16:01:12,480 - __main__ - INFO - Test folder: C:\Users\Nandini Devi\Downloads\uropds\UCSD_Anomaly_Dataset.v1p2\UCSDped1\Test\Test001
2025-12-01 16:01:13,010 - __main__ - INFO - ✓ Model loaded successfully (direct)
2025-12-01 16:01:15,405 - utils.data_loader - INFO - Loaded 200 test frames from C:\Users\Nandini Devi\Downloads\uropds\UCSD_Anomaly_Dataset.v1p2\UCSDped1\Test\Test001
2025-12-01 16:01:15,406 - __main__ - INFO - ✓ Loaded 200 frames
2025-12-01 16:01:15,406 - utils.data_loader - WARNING - Ground truth not found at C:\Users\Nandini Devi\Downloads\uropds\UCSD_Anomaly_Dataset.v1p2\UCSDped1\Test\Test001_gt
2025-12-01 16:01:15,407 - __main__ - INFO - ✓ Ground truth loaded (0 anomalies)
2025-12-01 16:01:15,407 - __main__ - INFO - Calculating reconstruction errors...
2025-12-01 16:01:18,776 - __main__ - INFO - ✓ Reconstruction errors calculated
2025-12-01 16:01:18,784 - __main__ - INFO - 
RESULTS
2025-12-01 16:01:18,784 - __main__ - INFO - Threshold (MSE): 0.004117
2025-12-01 16:01:18,785 - __main__ - INFO - Accuracy: 95.00%
2025-12-01 16:01:18,785 - __main__ - INFO - Precision: 0.00%
2025-12-01 16:01:18,785 - __main__ - INFO - Recall: 0.00%
2025-12-01 16:01:18,786 - __main__ - INFO - F1-Score: 0.0000
2025-12-01 16:01:18,786 - __main__ - INFO - AUC-ROC: N/A
2025-12-01 16:01:18,786 - __main__ - INFO - 
Confusion Matrix:
2025-12-01 16:01:18,787 - __main__ - INFO -   TP: 0, TN: 190
2025-12-01 16:01:18,787 - __main__ - INFO -   FP: 10, FN: 0
2025-12-01 16:01:18,790 - __main__ - INFO - 
============================================================
2025-12-01 16:01:18,791 - __main__ - INFO - Evaluating: Attacked (No Defense)
2025-12-01 16:01:18,791 - __main__ - INFO - Model path: C:\Users\Nandini Devi\FedGuard-Project\results\models\global_model_insecured.h5
2025-12-01 16:01:18,791 - __main__ - INFO - Test folder: C:\Users\Nandini Devi\Downloads\uropds\UCSD_Anomaly_Dataset.v1p2\UCSDped1\Test\Test001
2025-12-01 16:01:19,058 - __main__ - INFO - ✓ Model loaded successfully (direct)
2025-12-01 16:01:19,142 - utils.data_loader - INFO - Loaded 200 test frames from C:\Users\Nandini Devi\Downloads\uropds\UCSD_Anomaly_Dataset.v1p2\UCSDped1\Test\Test001
2025-12-01 16:01:19,142 - __main__ - INFO - ✓ Loaded 200 frames
2025-12-01 16:01:19,143 - utils.data_loader - WARNING - Ground truth not found at C:\Users\Nandini Devi\Downloads\uropds\UCSD_Anomaly_Dataset.v1p2\UCSDped1\Test\Test001_gt
2025-12-01 16:01:19,144 - __main__ - INFO - ✓ Ground truth loaded (0 anomalies)
2025-12-01 16:01:19,144 - __main__ - INFO - Calculating reconstruction errors...
2025-12-01 16:01:22,379 - __main__ - INFO - ✓ Reconstruction errors calculated
2025-12-01 16:01:22,386 - __main__ - INFO - 
RESULTS
2025-12-01 16:01:22,387 - __main__ - INFO - Threshold (MSE): 0.319115
2025-12-01 16:01:22,387 - __main__ - INFO - Accuracy: 95.00%
2025-12-01 16:01:22,387 - __main__ - INFO - Precision: 0.00%
2025-12-01 16:01:22,388 - __main__ - INFO - Recall: 0.00%
2025-12-01 16:01:22,388 - __main__ - INFO - F1-Score: 0.0000
2025-12-01 16:01:22,388 - __main__ - INFO - AUC-ROC: N/A
2025-12-01 16:01:22,389 - __main__ - INFO - 
Confusion Matrix:
2025-12-01 16:01:22,389 - __main__ - INFO -   TP: 0, TN: 190
2025-12-01 16:01:22,389 - __main__ - INFO -   FP: 10, FN: 0
2025-12-01 16:01:22,392 - __main__ - INFO - 
============================================================
2025-12-01 16:01:22,393 - __main__ - INFO - COMPARISON RESULTS
2025-12-01 16:01:22,393 - __main__ - INFO - ============================================================
2025-12-01 16:01:22,394 - __main__ - INFO - Accuracy: Secure=0.9500, Attacked=0.9500, Improvement=+0.00%
2025-12-01 16:01:22,394 - __main__ - INFO - Precision: Secure=0.0000, Attacked=0.0000, Improvement=+0.00%
2025-12-01 16:01:22,394 - __main__ - INFO - Recall: Secure=0.0000, Attacked=0.0000, Improvement=+0.00%
2025-12-01 16:01:22,395 - __main__ - INFO - F1-Score: Secure=0.0000, Attacked=0.0000, Improvement=+0.00%
2025-12-01 16:01:22,395 - __main__ - INFO - AUC-ROC: Secure=0.0000, Attacked=0.0000, Improvement=+0.00%
2025-12-01 16:01:22,399 - __main__ - INFO - 
Detailed results saved to: C:\Users\Nandini Devi\FedGuard-Project\results\metrics\evaluation_results.json
2025-12-01 16:10:56,865 - __main__ - INFO - 
FEDGUARD MODEL COMPARISON
2025-12-01 16:10:56,866 - __main__ - INFO - 
============================================================
2025-12-01 16:10:56,866 - __main__ - INFO - Evaluating: FedGuard (Secure)
2025-12-01 16:10:56,866 - __main__ - INFO - Model path: C:\Users\Nandini Devi\FedGuard-Project\results\models\global_model_secured.h5
2025-12-01 16:10:56,866 - __main__ - INFO - Test folder: C:\Users\Nandini Devi\Downloads\uropds\UCSD_Anomaly_Dataset.v1p2\UCSDped1\Test\Test003
2025-12-01 16:10:57,217 - __main__ - INFO - ✓ Model loaded successfully (direct)
2025-12-01 16:10:59,517 - utils.data_loader - INFO - Loaded 200 test frames from C:\Users\Nandini Devi\Downloads\uropds\UCSD_Anomaly_Dataset.v1p2\UCSDped1\Test\Test003
2025-12-01 16:10:59,517 - __main__ - INFO - ✓ Loaded 200 frames
2025-12-01 16:11:01,226 - utils.data_loader - INFO - Ground truth: 110/200 anomaly frames
2025-12-01 16:11:01,226 - __main__ - INFO - ✓ Ground truth loaded (110 anomalies)
2025-12-01 16:11:01,227 - __main__ - INFO - Calculating reconstruction errors...
2025-12-01 16:11:04,679 - __main__ - INFO - ✓ Reconstruction errors calculated
2025-12-01 16:11:04,688 - __main__ - INFO - 
RESULTS
2025-12-01 16:11:04,689 - __main__ - INFO - Threshold (MSE): 0.006750
2025-12-01 16:11:04,689 - __main__ - INFO - Accuracy: 50.00%
2025-12-01 16:11:04,689 - __main__ - INFO - Precision: 100.00%
2025-12-01 16:11:04,690 - __main__ - INFO - Recall: 9.09%
2025-12-01 16:11:04,690 - __main__ - INFO - F1-Score: 0.1667
2025-12-01 16:11:04,690 - __main__ - INFO - AUC-ROC: 0.9896
2025-12-01 16:11:04,691 - __main__ - INFO - 
Confusion Matrix:
2025-12-01 16:11:04,691 - __main__ - INFO -   TP: 10, TN: 90
2025-12-01 16:11:04,691 - __main__ - INFO -   FP: 0, FN: 100
2025-12-01 16:11:04,696 - __main__ - INFO - 
============================================================
2025-12-01 16:11:04,697 - __main__ - INFO - Evaluating: Attacked (No Defense)
2025-12-01 16:11:04,697 - __main__ - INFO - Model path: C:\Users\Nandini Devi\FedGuard-Project\results\models\global_model_insecured.h5
2025-12-01 16:11:04,698 - __main__ - INFO - Test folder: C:\Users\Nandini Devi\Downloads\uropds\UCSD_Anomaly_Dataset.v1p2\UCSDped1\Test\Test003
2025-12-01 16:11:04,944 - __main__ - INFO - ✓ Model loaded successfully (direct)
2025-12-01 16:11:05,030 - utils.data_loader - INFO - Loaded 200 test frames from C:\Users\Nandini Devi\Downloads\uropds\UCSD_Anomaly_Dataset.v1p2\UCSDped1\Test\Test003
2025-12-01 16:11:05,082 - __main__ - INFO - ✓ Loaded 200 frames
2025-12-01 16:11:05,140 - utils.data_loader - INFO - Ground truth: 110/200 anomaly frames
2025-12-01 16:11:05,141 - __main__ - INFO - ✓ Ground truth loaded (110 anomalies)
2025-12-01 16:11:05,141 - __main__ - INFO - Calculating reconstruction errors...
2025-12-01 16:11:08,281 - __main__ - INFO - ✓ Reconstruction errors calculated
2025-12-01 16:11:08,287 - __main__ - INFO - 
RESULTS
2025-12-01 16:11:08,287 - __main__ - INFO - Threshold (MSE): 0.325007
2025-12-01 16:11:08,288 - __main__ - INFO - Accuracy: 49.00%
2025-12-01 16:11:08,288 - __main__ - INFO - Precision: 90.00%
2025-12-01 16:11:08,288 - __main__ - INFO - Recall: 8.18%
2025-12-01 16:11:08,289 - __main__ - INFO - F1-Score: 0.1500
2025-12-01 16:11:08,289 - __main__ - INFO - AUC-ROC: 0.5479
2025-12-01 16:11:08,290 - __main__ - INFO - 
Confusion Matrix:
2025-12-01 16:11:08,290 - __main__ - INFO -   TP: 9, TN: 89
2025-12-01 16:11:08,290 - __main__ - INFO -   FP: 1, FN: 101
2025-12-01 16:11:08,292 - __main__ - INFO - 
============================================================
2025-12-01 16:11:08,293 - __main__ - INFO - COMPARISON RESULTS
2025-12-01 16:11:08,293 - __main__ - INFO - ============================================================
2025-12-01 16:11:08,293 - __main__ - INFO - Accuracy: Secure=0.5000, Attacked=0.4900, Improvement=+2.04%
2025-12-01 16:11:08,293 - __main__ - INFO - Precision: Secure=1.0000, Attacked=0.9000, Improvement=+11.11%
2025-12-01 16:11:08,294 - __main__ - INFO - Recall: Secure=0.0909, Attacked=0.0818, Improvement=+11.11%
2025-12-01 16:11:08,294 - __main__ - INFO - F1-Score: Secure=0.1667, Attacked=0.1500, Improvement=+11.11%
2025-12-01 16:11:08,294 - __main__ - INFO - AUC-ROC: Secure=0.9896, Attacked=0.5479, Improvement=+80.62%
2025-12-01 16:11:08,297 - __main__ - INFO - 
Detailed results saved to: C:\Users\Nandini Devi\FedGuard-Project\results\metrics\evaluation_results.json
